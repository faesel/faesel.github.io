<!DOCTYPE html><!--nuf4gO4xDVHrlHALQrgG_--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/images/logo-small.png"/><link rel="preload" as="image" href="https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg"/><link rel="stylesheet" href="/_next/static/chunks/19d110f125a6a880.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/4c98436a675d5713.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/ba947f6798c3c403.js"/><script src="/_next/static/chunks/9a513a8c4dabec14.js" async=""></script><script src="/_next/static/chunks/713fc8ad9ceac69a.js" async=""></script><script src="/_next/static/chunks/19e94e7551cef099.js" async=""></script><script src="/_next/static/chunks/turbopack-2ca5897f65736e1e.js" async=""></script><script src="/_next/static/chunks/8be72f203fe36d6f.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/708205fa81a1891d.js" async=""></script><script src="/_next/static/chunks/34e59d4fa8652639.js" async=""></script><link rel="preload" href="/_next/static/chunks/578ca6ed020117e9.css" as="style"/><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-Y039CLFJME" as="script"/><title>.NET &amp; GRPC What they forgot to tell you | Tech Blog | FAESEL.COM</title><meta name="description" content="As an engineer, I have always had a heavy reliance on REST&#x27;ful API&#x27;s for passing information between applications. With the introduction of [open API specificat"/><link rel="author" href="https://www.faesel.com/about"/><meta name="author" content="Faesel Saeed"/><meta name="keywords" content="grpc,.net,c#,asp.net,grpc-web,rest,nswag,proto-files,nuget,grpc-reflection,bloomrpc"/><meta property="og:title" content=".NET &amp; GRPC What they forgot to tell you"/><meta property="og:description" content="As an engineer, I have always had a heavy reliance on REST&#x27;ful API&#x27;s for passing information between applications. With the introduction of [open API specificat"/><meta property="og:image" content="https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2020-09-08T00:00+01:00"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@faeselsaeed"/><meta name="twitter:creator" content="@faeselsaeed"/><meta name="twitter:title" content=".NET &amp; GRPC What they forgot to tell you"/><meta name="twitter:description" content="As an engineer, I have always had a heavy reliance on REST&#x27;ful API&#x27;s for passing information between applications. With the introduction of [open API specificat"/><meta name="twitter:image" content="https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/favicon.ico"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com","logo":{"@type":"ImageObject","url":"https://www.faesel.com/images/logo.png"},"sameAs":["https://github.com/faesel","https://www.linkedin.com/in/faesel-saeed-a97b1614"]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"FAESEL.COM","url":"https://www.faesel.com","description":"A modern tech blog exploring technology, coding, and digital innovation","publisher":{"@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com"}}</script><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><a href="#main-content" class="skip-to-content">Skip to content</a><header class="Header-module__hBw1pG__header"><div class="Header-module__hBw1pG__container"><a class="Header-module__hBw1pG__logo" aria-label="Home" href="/"><img alt="Logo" width="40" height="40" decoding="async" data-nimg="1" class="Header-module__hBw1pG__logoImage" style="color:transparent" src="/images/logo-small.png"/></a><button class="Header-module__hBw1pG__mobileMenuButton" aria-label="Toggle menu" aria-expanded="false">‚ò∞</button><nav class="Header-module__hBw1pG__nav " role="navigation" aria-label="Main navigation"><a class="Header-module__hBw1pG__navLink " href="/">Home</a><a class="Header-module__hBw1pG__navLink " href="/blog">Blog</a><a class="Header-module__hBw1pG__navLink " href="/projects">Projects</a><a class="Header-module__hBw1pG__navLink " href="/about">About</a><a class="Header-module__hBw1pG__navLink " href="/contact">Contact</a></nav></div></header><main id="main-content" style="min-height:70vh"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":".NET & GRPC What they forgot to tell you","description":"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat","image":"https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg","datePublished":"2020-09-08T00:00+01:00","dateModified":"2020-09-08T00:00+01:00","author":{"@type":"Person","name":"Faesel Saeed","url":"https://www.faesel.com/about"},"publisher":{"@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com","logo":{"@type":"ImageObject","url":"https://www.faesel.com/images/logo.png"}},"keywords":"grpc, .net, c#, asp.net, grpc-web, rest, nswag, proto-files, nuget, grpc-reflection, bloomrpc","url":"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you"}}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.faesel.com"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://www.faesel.com/blog"},{"@type":"ListItem","position":3,"name":".NET & GRPC What they forgot to tell you","item":"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you"}]}</script><article class="page-module__dgei_G__article"><a class="page-module__dgei_G__backLink" href="/blog">‚Üê Back to Blog</a><header class="page-module__dgei_G__header"><h1 class="page-module__dgei_G__title">.NET &amp; GRPC What they forgot to tell you</h1><div class="page-module__dgei_G__meta"><time class="page-module__dgei_G__date" dateTime="2020-09-08T00:00+01:00">üìÖ <!-- -->September 7, 2020</time><span class="page-module__dgei_G__separator">‚Ä¢</span><span class="page-module__dgei_G__readingTime">‚è±Ô∏è <!-- -->9 min read</span></div><div class="page-module__dgei_G__tags"><span class="page-module__dgei_G__tag">grpc</span><span class="page-module__dgei_G__tag">.net</span><span class="page-module__dgei_G__tag">c#</span><span class="page-module__dgei_G__tag">asp.net</span><span class="page-module__dgei_G__tag">grpc-web</span><span class="page-module__dgei_G__tag">rest</span><span class="page-module__dgei_G__tag">nswag</span><span class="page-module__dgei_G__tag">proto-files</span><span class="page-module__dgei_G__tag">nuget</span><span class="page-module__dgei_G__tag">grpc-reflection</span><span class="page-module__dgei_G__tag">bloomrpc</span></div></header><div class="page-module__dgei_G__heroImage"><img alt=".NET &amp; GRPC What they forgot to tell you" decoding="async" data-nimg="fill" class="page-module__dgei_G__heroImageImg" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg"/></div><div class="ShareButtons-module__iQZDeW__floating"><div class="ShareButtons-module__iQZDeW__buttons"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you&amp;text=.NET%20%26%20GRPC%20What%20they%20forgot%20to%20tell%20you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__twitter" aria-label="Share on Twitter"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__linkedin" aria-label="Share on LinkedIn"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__facebook" aria-label="Share on Facebook"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a href="https://reddit.com/submit?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you&amp;title=.NET%20%26%20GRPC%20What%20they%20forgot%20to%20tell%20you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__reddit" aria-label="Share on Reddit"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"></path></svg></a><a href="mailto:?subject=.NET%20%26%20GRPC%20What%20they%20forgot%20to%20tell%20you&amp;body=As%20an%20engineer%2C%20I%20have%20always%20had%20a%20heavy%20reliance%20on%20REST&#x27;ful%20API&#x27;s%20for%20passing%20information%20between%20applications.%20With%20the%20introduction%20of%20%5Bopen%20API%20specificat%0A%0Ahttps%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__email" aria-label="Share via Email"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a><button class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__copy " aria-label="Copy link"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div></div><div class="page-module__dgei_G__content"><p>As an engineer, I have always had a heavy reliance on REST&#39;ful API&#39;s for passing information between applications. With the introduction of <a href="https://swagger.io/specification/">open API specification</a> now in version 3.0.3, integration has never been easier. The push to break monoliths into microservices has further boosted its usage, however I always found one size never fits all.</p>
<h2>Where REST falls down üëé</h2>
<p>RESTful services have many shortfalls built in, if you&#39;re in my boat and most of the time your creating services and working on client applications. Having to tailor a client library to call those services has always been a tiresome task. 3rd party tooling like <a href="https://github.com/RicoSuter/NSwag">Nswag</a> made some attempt to fix this problem however I still find breaking changes between versions that make huge changesets across all your endpoints. If your working across multiple languages like C# and Javascript your work doubles up. </p>
<p>There are also encumbrances experienced when mixing batch/bulk operations, overnight jobs with REST&#39;ful APIs. Leading to complex solutions that auto scale or spread load over time. Having to go through each request-response cycle on bulk is just in-efficient.</p>
<p>In most cases, responses are also in the form of JSON which is designed to cater for human readability at the expense of being inefficient. If you talking machine to machine readability is not a concern?  </p>
<p>Lets also not mention those endless subjective PR threads trying to decide whats RESTful and whats not üòá.</p>
<h2>Can GRPC fill the gaps ü§∑‚Äç‚ôÇÔ∏è</h2>
<p>If you experienced the REST&#39;ful pains above, GRPC&#39;s got your back. To get a quick demonstration of its capabilities, I recommend <a href="http://wildermuth.com/2020/07/09/gRPC-Talk-at-netPonto">Shawn Wildermuth&#39;s gRPC Talk at netPonto User Group (2020)</a> he explains it in a easy to understand way.</p>
<p><a href="https://www.youtube.com/watch?v=3wUtQb6C7to">https://www.youtube.com/watch?v=3wUtQb6C7to</a></p>
<p>To sum up its capabilities it has two key differences to REST (if your already familiar with this, skip to section <strong>Things to look into</strong>).</p>
<h3>1. Proto files</h3>
<p>Proto files contain the definition of your API in a structured spec compliant way. The code below shows a simple <em>GreetingsService</em> with a basic request and response.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-attribute">syntax</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;proto3&quot;</span><span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">option csharp_namespace <span class="hljs-operator">=</span> <span class="hljs-string">&quot;HelloService&quot;</span><span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">service GreetingsService {</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    rpc GetHello (HelloRequest) returns (HelloResponse)<span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">message HelloRequest {</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">    int32 HelloCount <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">message HelloResponse {</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">    string HelloDescription <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">}</span></span></code></pre><p>Proto files can then be used to transpile code <a href="https://grpc.io/docs/languages/">into many languages</a>. When transpiling we have the option to either create code for a <strong>server</strong> or <strong>client</strong>. Code generation creates a base class <strong>GreetingsServiceBase</strong> for us (it&#39;s generated in the bin folder on build time). Eventually, you end up with a service that looks like this:</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">using</span> Grpc.Core;</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">using</span> HelloServer;</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"><span class="hljs-keyword">using</span> System.Threading.Tasks;</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content"><span class="hljs-keyword">namespace</span> <span class="hljs-title">TaxServer.Services</span></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">HelloGrpcService</span> : <span class="hljs-title">GreetingsService.GreetingsServiceBase</span></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task&lt;HelloResponse&gt; <span class="hljs-title">GetHello</span>(<span class="hljs-params">HelloRequest request, ServerCallContext context</span>)</span></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> HelloResponse { HelloDescription = <span class="hljs-string">$&quot;<span class="hljs-subst">{request.HelloCount}</span> Hellos to you!&quot;</span> };</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">}</span></span></code></pre><p>The act of sharing and distributing proto files means that consuming clients can easily create their own client code and be completely agnostic of language.</p>
<h3>2. Defining request/response lifecycle</h3>
<p>GRPC allows you to change its request/response lifecycle, it has 4 options described below,</p>
<ul>
<li><strong>Unary RPC&#39;s</strong>: Unary RPCs where the client sends a single request to the server and gets a single response back.</li>
<li><strong>Server Streaming RPC&#39;s</strong>: Server streaming RPCs where the client sends a request to the server and gets a stream to read a sequence of messages back.</li>
<li><strong>Client Streaming RPC&#39;s</strong>: Client streaming RPCs where the client writes a sequence of messages and sends them to the server, again using a provided stream.</li>
<li><strong>Bi-Directional Streaming RPC&#39;s</strong>: Bidirectional streaming RPCs where both sides send a sequence of messages using a read-write stream.</li>
</ul>
<p><a href="https://grpc.io/docs/what-is-grpc/core-concepts/"><em>Taken from GRPC.io</em></a></p>
<p>These additional modes are more suited for batch processing over your traditional request/response lifecycle.</p>
<h2>Things to look into ‚úÖ</h2>
<p>So far so great, getting to this point is relatively easy and straightforward. Problem is all the tutorials seem to end at this point üòü. To have a live API several additional concerns need to be addressed. My list was as follows:</p>
<ol>
<li>Check how we can consume/distribute .proto files</li>
<li>How to create a health checking probe for a GRPC service</li>
<li>How to version endpoints</li>
<li>Can a .NET Framework client app consume a .NET Core GRPC server?</li>
<li>How to debug with tools, call an endpoint</li>
<li>Authentication and authorization</li>
<li>Can you call the service from a browser?</li>
</ol>
<h3>1. Check how we can consume/distribute .proto files</h3>
<p>There are two different approaches to achieve this, mainly dependent on whether your service is internal or external public facing.</p>
<h4>Option 1 - With nuget packages</h4>
<p>Option one is to distribute your proto files using Nuget packages. This solution is recommended in the situation where you are using GRPC for internal services. Your solution structure would look something like this:</p>
<ul>
<li>HelloService.Protos<br>- Hello.protos</li>
<li>HelloService.Server<br>- Server code ...</li>
</ul>
<p>In this case we would use a Nuspec file to package the .protos and output it into the following structure in the client app. Considering you could be consuming more than one GRPC service it might make sense to create subfolders to know where the proto file comes from.</p>
<ul>
<li>HelloClient<br>/Protos/<strong>service name goes gere</strong>/Hello.protos</li>
</ul>
<p>From here the client application can generate its client service code using the protofile. If you want to go one step further there is a dotnet command you can use to integrate the proto file into the <strong>.csproj</strong> file using a <a href="https://docs.microsoft.com/en-us/aspnet/core/grpc/dotnet-grpc?view=aspnetcore-3.1">dotnet command</a> which can be triggered after the installation of the package.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">dotnet grpc<span class="hljs-built_in"> add-file </span>Hello.proto</span></span></code></pre><h4>Option 2 - With a discovery endpoint</h4>
<p>This approach is recommended if your GRPC service is a service meant for external consumers. The idea behind this approach is to expose which services/endpoints are available. The method is dependent on the <a href="https://www.nuget.org/packages/Grpc.Reflection/"><strong>Grpc.Reflection</strong></a> Nuget package.</p>
<p>The general approach is outlined <a href="https://github.com/grpc/grpc/blob/master/doc/csharp/server_reflection.md">here</a>. </p>
<p>Once implemented it allows you to use an endpoint from the server code to generate your client code. Dotnet has a <a href="https://www.nuget.org/packages/dotnet-grpc-cli/">GRPC CLI tool</a>, that can read from a server reflection endpoint and produce a proto file out of it. The command looks like this,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">dotnet grpc-cli <span class="hljs-keyword">dump</span> https:<span class="hljs-comment">//localhost:5001 Reflection.HelloService</span></span></span></code></pre><p>You can also write the proto file to disk using this command</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">dotnet grpc-cli dump http://localhost:10042 Reflection.HelloService -o ./prot</span></span></code></pre><h3>2. How to create a health checking probe for a GRPC service</h3>
<p>Health checking probe endpoints are useful for monitoring uptime as well as managing containers when services are unresponsive. GRPC specification has a defined structure for creating your health checking endpoint called the <a href="https://github.com/grpc/grpc/blob/master/doc/health-checking.md"><strong>GRPC Health Checking Protocol</strong></a>. </p>
<p>However, since we are using asp.net core we can get away from this and rely on middleware to do this for us with little code.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">ConfigureServices</span><span class="hljs-params">(IServiceCollection services)</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"></span>{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">  services.<span class="hljs-built_in">AddGrpc</span>();</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">  services.<span class="hljs-built_in">AddHealthChecks</span>();</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">  ...</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">Configure</span><span class="hljs-params">(IApplicationBuilder app)</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"></span>{</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">  app.<span class="hljs-built_in">UseEndpoints</span>(endpoints =&gt;</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">  {</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">    endpoints.<span class="hljs-built_in">MapHealthChecks</span>(<span class="hljs-string">&quot;/healthz&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    ...</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">  });</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">}</span></span></code></pre><p>Now when running locally <strong><a href="https://localhost:5001/healthz">https://localhost:5001/healthz</a></strong> we can get a 200 response. Here is what the output logs look like:</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">      Request starting HTTP/<span class="hljs-number">2</span> GET https:<span class="hljs-comment">//localhost:5001/healthz</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Routing</span><span class="hljs-selector-class">.EndpointMiddleware</span><span class="hljs-selector-attr">[0]</span></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">      Executing endpoint <span class="hljs-string">&#x27;Health checks&#x27;</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Routing</span><span class="hljs-selector-class">.EndpointMiddleware</span><span class="hljs-selector-attr">[1]</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">      Executed endpoint <span class="hljs-string">&#x27;Health checks&#x27;</span></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Hosting</span><span class="hljs-selector-class">.Diagnostics</span><span class="hljs-selector-attr">[2]</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">      Request finished <span class="hljs-keyword">in</span> <span class="hljs-number">19.056ms</span> <span class="hljs-number">200</span> text/plain</span></span></code></pre><h3>3. How to version endpoints</h3>
<p>The problem of versioning is easily solved using namespaces, it&#39;s just a case of incorporating your version number into the namespace like so,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">option csharp_namespace <span class="hljs-operator">=</span> <span class="hljs-string">&quot;HelloService.v1&quot;</span><span class="hljs-comment">;</span></span></span></code></pre><p>For each version, you would have different proto files and different service implementations. When inheriting from the base we can be specific on the version we need.</p>
<p><strong>Server Code</strong></p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloGrpcService</span><span class="hljs-attr"> : HelloService</span>.<span class="hljs-title">v1</span>.<span class="hljs-title">GreetingsService</span>.<span class="hljs-title">GreetingsServiceBase</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"></span>{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">}</span></span></code></pre><p><strong>Client Code</strong></p>
<p>The namespaces segregate the types so it just works out.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-comment">//Version 1</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">using</span> <span class="hljs-built_in">var</span> channel = GrpcChannel.ForAddress(<span class="hljs-string">&quot;https://localhost:5001&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"><span class="hljs-built_in">var</span> <span class="hljs-keyword">client</span> = <span class="hljs-keyword">new</span> HelloService.v1.GreetingsService.GreetingsServiceClient(channel);</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"><span class="hljs-built_in">var</span> response = await <span class="hljs-keyword">client</span>.GetHello(<span class="hljs-keyword">new</span> HelloService.v1.HelloRequest() { </span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">      HelloCount = <span class="hljs-number">1</span></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">});</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content"><span class="hljs-comment">//Version 2</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"><span class="hljs-keyword">using</span> <span class="hljs-built_in">var</span> channel2 = GrpcChannel.ForAddress(<span class="hljs-string">&quot;https://localhost:5001&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content"><span class="hljs-built_in">var</span> client2 = <span class="hljs-keyword">new</span> HelloService.v2.GreetingsService.GreetingsServiceClient(channel);</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content"><span class="hljs-built_in">var</span> response2 = await client2.GetHello(<span class="hljs-keyword">new</span> HelloService.v2.HelloRequest() {</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">      HelloCount = <span class="hljs-number">2</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">});</span></span></code></pre><h3>4. Can a .NET Framework client app consume a .NET Core GRPC server?</h3>
<p>Turns out it can yes, however ... as GRPC is built upon HTTP/2 which is not supported in .net framework, making secure connections to your API is not possible. The client code for .net framework is very similar, we just pass a <strong>ChannelCredentials.Insecure</strong> option in when building the client.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-built_in">var</span> channel = <span class="hljs-keyword">new</span> Channel(<span class="hljs-string">&quot;127.0.0.1&quot;</span>, <span class="hljs-number">5000</span>, ChannelCredentials.Insecure);</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-built_in">var</span> <span class="hljs-keyword">client</span> = <span class="hljs-keyword">new</span> GreetingsService.GreetingsServiceClient(channel);</span></span></code></pre><h3>5. How to debug with tools, call an endpoint</h3>
<p>If you&#39;re like me and you&#39;ve come from a REST background your most likely used to polished tools like Postman or Insomnia to test out your endpoints. Sadly these tools don&#39;t support GRPC üò¢... yet anyway...</p>
<p>The <a href="https://github.com/grpc-ecosystem/awesome-grpc#lang-cs">GRPC Tooling Community</a> is still in its infancy. There are however some new players that are emerging that get the job done, most notably for me BloomRPC. </p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/6p6bGkCU7Tpa3tMwPsoRxO/adb23285ed92ea9c2c757ef62a4600a9/BloomRPC.png" alt="BloomRPC"></p>
<p>After importing in your proto files you get a great swagger-esk UI that automatically build up your request body from your proto file.</p>
<h3>6. Authentication and authorization</h3>
<p>Because we are working under the guise of asp.net core we can take advantage of its authentication middleware. The following authentication methods are supported.</p>
<ul>
<li>Azure Active Directory</li>
<li>Client Certificate</li>
<li>IdentityServer</li>
<li>JWT Token</li>
<li>OAuth 2.0</li>
<li>OpenID Connect</li>
<li>WS-Federation</li>
</ul>
<p>Below is a simple code example of authenticating a JWT token with an identity service. As you can see its no different from a REST service.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> ConfigureServices(IServiceCollection services)</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    var authority = <span class="hljs-string">&quot;https://myidentityserver.com&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    services</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">        .AddAuthentication(<span class="hljs-string">&quot;Bearer&quot;</span>)</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        .AddJwtBearer(<span class="hljs-string">&quot;Bearer&quot;</span>, <span class="hljs-keyword">options</span> =&gt;</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">            <span class="hljs-keyword">options</span>.Authority = authority;</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">            <span class="hljs-keyword">options</span>.RequireHttpsMetadata = <span class="hljs-keyword">false</span>;</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">            <span class="hljs-keyword">options</span>.TokenValidationParameters = <span class="hljs-keyword">new</span> TokenValidationParameters</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">            {</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">                ValidateAudience = <span class="hljs-keyword">false</span>,</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">            };</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">            <span class="hljs-keyword">options</span>.ConfigurationManager = <span class="hljs-keyword">new</span> ConfigurationManager&lt;OpenIdConnectConfiguration&gt;</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">            (</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">                metadataAddress: authority + <span class="hljs-string">&quot;/.well-known/openid-configuration&quot;</span>,</span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">                configRetriever: <span class="hljs-keyword">new</span> OpenIdConnectConfigurationRetriever(),</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">                docRetriever: <span class="hljs-keyword">new</span> HttpDocumentRetriever { RequireHttps = <span class="hljs-keyword">false</span> }</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">            );</span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">            <span class="hljs-keyword">options</span>.Events = <span class="hljs-keyword">new</span> JwtBearerEvents</span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">            {</span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content">                OnTokenValidated = context =&gt;</span></span>
<span class="code-line"><span class="line-number">24</span><span class="line-content">                {</span></span>
<span class="code-line"><span class="line-number">25</span><span class="line-content">                    var ci = (ClaimsIdentity)context.Principal.Identity;</span></span>
<span class="code-line"><span class="line-number">26</span><span class="line-content">                    var authHeader = context.Request.Headers[<span class="hljs-string">&quot;Authorization&quot;</span>];</span></span>
<span class="code-line"><span class="line-number">27</span><span class="line-content">                    var token = authHeader.FirstOrDefault()?.Substring(<span class="hljs-number">7</span>);</span></span>
<span class="code-line"><span class="line-number">28</span><span class="line-content">                    <span class="hljs-keyword">if</span> (token != <span class="hljs-keyword">null</span>)</span></span>
<span class="code-line"><span class="line-number">29</span><span class="line-content">                    {</span></span>
<span class="code-line"><span class="line-number">30</span><span class="line-content">                        ci.AddClaim(<span class="hljs-keyword">new</span> Claim(<span class="hljs-string">&quot;token&quot;</span>, token));</span></span>
<span class="code-line"><span class="line-number">31</span><span class="line-content">                    }</span></span>
<span class="code-line"><span class="line-number">32</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">33</span><span class="line-content">                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">Task</span>.CompletedTask;</span></span>
<span class="code-line"><span class="line-number">34</span><span class="line-content">                }</span></span>
<span class="code-line"><span class="line-number">35</span><span class="line-content">            };</span></span>
<span class="code-line"><span class="line-number">36</span><span class="line-content">        });</span></span>
<span class="code-line"><span class="line-number">37</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">38</span><span class="line-content">    services.AddAuthorization();</span></span>
<span class="code-line"><span class="line-number">39</span><span class="line-content">    ...</span></span>
<span class="code-line"><span class="line-number">40</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">41</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">42</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> Configure(IApplicationBuilder app)</span></span>
<span class="code-line"><span class="line-number">43</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">44</span><span class="line-content">    app.UseAuthentication();</span></span>
<span class="code-line"><span class="line-number">45</span><span class="line-content">    app.UseAuthorization();</span></span>
<span class="code-line"><span class="line-number">46</span><span class="line-content">    ...</span></span>
<span class="code-line"><span class="line-number">47</span><span class="line-content">}</span></span></code></pre><p>Below is output from an authenticated request:</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">      Request starting HTTP/<span class="hljs-number">2</span> POST https:<span class="hljs-comment">//localhost:5001/HelloGrpcService.GreetingsService/GetHello application/grpc</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Authentication</span><span class="hljs-selector-class">.JwtBearer</span><span class="hljs-selector-class">.JwtBearerHandler</span><span class="hljs-selector-attr">[2]</span></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">      Successfully validated the token.</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Authorization</span><span class="hljs-selector-class">.DefaultAuthorizationService</span><span class="hljs-selector-attr">[1]</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">      Authorization was successful.</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Routing</span><span class="hljs-selector-class">.EndpointMiddleware</span><span class="hljs-selector-attr">[0]</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">      Executing endpoint <span class="hljs-string">&#x27;gRPC - /HelloGrpcService.GreetingsService/GetHello&#x27;</span></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">Request parameter <span class="hljs-number">1</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">Request came from test-client-id</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Routing</span><span class="hljs-selector-class">.EndpointMiddleware</span><span class="hljs-selector-attr">[1]</span></span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">      Executed endpoint <span class="hljs-string">&#x27;gRPC - /HelloGrpcService.GreetingsService/GetHello&#x27;</span></span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">info: Microsoft<span class="hljs-selector-class">.AspNetCore</span><span class="hljs-selector-class">.Hosting</span><span class="hljs-selector-class">.Diagnostics</span><span class="hljs-selector-attr">[2]</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">      Request finished <span class="hljs-keyword">in</span> <span class="hljs-number">5865.2411ms</span> <span class="hljs-number">200</span> application/grpc</span></span></code></pre><h3>7. Can you call the service from a browser?</h3>
<p>Currently, as it stands the answer is no, browsers don&#39;t offer fine-grained control over API requests to support GRPC. However, there is some light at the end of the tunnel.</p>
<p>Back in 2016 Google started working on a specification for &quot;GRPC for the browser&quot;. You can read more about it <a href="https://grpc.io/blog/state-of-grpc-web/">here</a> but in essence,</p>
<blockquote>
<p>The basic idea is to have the browser send normal HTTP requests (with Fetch or XHR) and have a small proxy in front of the gRPC server to translate the requests and responses to something the browser can use - grpc.io</p>
</blockquote>
<p>In the C# world, Microsoft has an implementation of this specification in their docs, <a href="https://docs.microsoft.com/en-gb/aspnet/core/grpc/browser?view=aspnetcore-3.1">Use gRPC in browser apps</a>.</p>
<p>There are some disclaimers to this, as gRPC supports streaming and bidirectional requests this addition is only recommended for unary requests. Due to this limiting factor helpers are present to turn it on and off for services when setting up GRPC services in the startup,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">endpoints<span class="hljs-selector-class">.MapGrpcService</span>&lt;HelloGrpcService&gt;()<span class="hljs-selector-class">.EnableGrpcWeb</span>()<span class="hljs-selector-class">.RequireCors</span>(&quot;AllowAll&quot;);</span></span></code></pre><p>What I find particularly interesting is that the problem grpc-web solves is similar to the problems we have with .net framework (https/2 is not supported). Could this perhaps be an answer to getting secure requests working? ... sadly not yet! at the moment its not possible as grpc-web was was built on .net standard 2.1 so .net framework is not supported. Perhaps there might be movement on this in time to come.</p>
<h2>Things I missed out</h2>
<ol>
<li>Integration Testing, im a big fan of using in memory testing with Test Server it would be interesting to see if this works with a GRPC service.</li>
</ol>
<h2>Useful Links</h2>
<ol>
<li><a href="https://github.com/grpc/grpc/tree/master/src/csharp">C# Examples</a></li>
<li><a href="https://github.com/grpc/grpc-dotnet/tree/master/examples">More c# examples</a></li>
</ol>
</div><div class="ShareButtons-module__iQZDeW__container"><div class="ShareButtons-module__iQZDeW__label">Share this article</div><div class="ShareButtons-module__iQZDeW__buttons"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you&amp;text=.NET%20%26%20GRPC%20What%20they%20forgot%20to%20tell%20you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__twitter" aria-label="Share on Twitter"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__linkedin" aria-label="Share on LinkedIn"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__facebook" aria-label="Share on Facebook"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a href="https://reddit.com/submit?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you&amp;title=.NET%20%26%20GRPC%20What%20they%20forgot%20to%20tell%20you" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__reddit" aria-label="Share on Reddit"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"></path></svg></a><a href="mailto:?subject=.NET%20%26%20GRPC%20What%20they%20forgot%20to%20tell%20you&amp;body=As%20an%20engineer%2C%20I%20have%20always%20had%20a%20heavy%20reliance%20on%20REST&#x27;ful%20API&#x27;s%20for%20passing%20information%20between%20applications.%20With%20the%20introduction%20of%20%5Bopen%20API%20specificat%0A%0Ahttps%3A%2F%2Fwww.faesel.com%2Fblog%2Fdotnet-grpc-forgot-to-tell-you" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__email" aria-label="Share via Email"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a><button class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__copy " aria-label="Copy link"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div></div></article><!--$--><!--/$--></main><footer class="Footer-module__S6Hkya__footer"><div class="Footer-module__S6Hkya__container"><div class="Footer-module__S6Hkya__content"><nav class="Footer-module__S6Hkya__links" aria-label="Footer navigation"><a class="Footer-module__S6Hkya__link" href="/blog">Blog</a><a class="Footer-module__S6Hkya__link" href="/projects">Projects</a><a class="Footer-module__S6Hkya__link" href="/about">About</a><a class="Footer-module__S6Hkya__link" href="/contact">Contact</a></nav><p class="Footer-module__S6Hkya__copyright">¬© <!-- -->2026<!-- --> All rights reserved.</p></div></div></footer><script src="/_next/static/chunks/ba947f6798c3c403.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[31362,[\"/_next/static/chunks/8be72f203fe36d6f.js\"],\"default\"]\n3:I[2971,[\"/_next/static/chunks/8be72f203fe36d6f.js\"],\"default\"]\n4:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"default\"]\n5:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"default\"]\n6:I[22016,[\"/_next/static/chunks/8be72f203fe36d6f.js\",\"/_next/static/chunks/34e59d4fa8652639.js\"],\"\"]\n8:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"OutletBoundary\"]\n9:\"$Sreact.suspense\"\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"ViewportBoundary\"]\nd:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"MetadataBoundary\"]\nf:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"default\"]\n:HL[\"/_next/static/chunks/19d110f125a6a880.css\",\"style\"]\n:HL[\"/_next/static/chunks/4c98436a675d5713.css\",\"style\"]\n:HL[\"/_next/static/chunks/578ca6ed020117e9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"nuf4gO4xDVHrlHALQrgG-\",\"c\":[\"\",\"blog\",\"dotnet-grpc-forgot-to-tell-you\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"dotnet-grpc-forgot-to-tell-you\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/19d110f125a6a880.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/8be72f203fe36d6f.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"Organization\\\",\\\"name\\\":\\\"Faesel Saeed\\\",\\\"url\\\":\\\"https://www.faesel.com\\\",\\\"logo\\\":{\\\"@type\\\":\\\"ImageObject\\\",\\\"url\\\":\\\"https://www.faesel.com/images/logo.png\\\"},\\\"sameAs\\\":[\\\"https://github.com/faesel\\\",\\\"https://www.linkedin.com/in/faesel-saeed-a97b1614\\\"]}\"}}],[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"WebSite\\\",\\\"name\\\":\\\"FAESEL.COM\\\",\\\"url\\\":\\\"https://www.faesel.com\\\",\\\"description\\\":\\\"A modern tech blog exploring technology, coding, and digital innovation\\\",\\\"publisher\\\":{\\\"@type\\\":\\\"Organization\\\",\\\"name\\\":\\\"Faesel Saeed\\\",\\\"url\\\":\\\"https://www.faesel.com\\\"}}\"}}]]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L2\",null,{\"gaId\":\"G-Y039CLFJME\"}],[\"$\",\"a\",null,{\"href\":\"#main-content\",\"className\":\"skip-to-content\",\"children\":\"Skip to content\"}],[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"id\":\"main-content\",\"style\":{\"minHeight\":\"70vh\"},\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"not-found-module__HS70Aa__container\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"not-found-module__HS70Aa__title\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"not-found-module__HS70Aa__subtitle\",\"children\":\"Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"not-found-module__HS70Aa__message\",\"children\":\"Sorry, the page you're looking for doesn't exist.\"}],[\"$\",\"$L6\",null,{\"href\":\"/\",\"className\":\"not-found-module__HS70Aa__homeLink\",\"children\":\"Go Home\"}]]}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/578ca6ed020117e9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"Footer-module__S6Hkya__footer\",\"children\":[\"$\",\"div\",null,{\"className\":\"Footer-module__S6Hkya__container\",\"children\":[\"$\",\"div\",null,{\"className\":\"Footer-module__S6Hkya__content\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"Footer-module__S6Hkya__links\",\"aria-label\":\"Footer navigation\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/blog\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"Blog\"}],[\"$\",\"$L6\",null,{\"href\":\"/projects\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"Projects\"}],[\"$\",\"$L6\",null,{\"href\":\"/about\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"About\"}],[\"$\",\"$L6\",null,{\"href\":\"/contact\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"Contact\"}]]}],[\"$\",\"p\",null,{\"className\":\"Footer-module__S6Hkya__copyright\",\"children\":[\"¬© \",2026,\" All rights reserved.\"]}]]}]}]}]]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/4c98436a675d5713.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/34e59d4fa8652639.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@a\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.Metadata\",\"children\":\"$Le\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"11:I[5500,[\"/_next/static/chunks/8be72f203fe36d6f.js\",\"/_next/static/chunks/34e59d4fa8652639.js\"],\"Image\"]\n12:I[23150,[\"/_next/static/chunks/8be72f203fe36d6f.js\",\"/_next/static/chunks/34e59d4fa8652639.js\"],\"default\"]\n15:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"IconMark\"]\n10:T403,{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\".NET \u0026 GRPC What they forgot to tell you\",\"description\":\"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat\",\"image\":\"https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg\",\"datePublished\":\"2020-09-08T00:00+01:00\",\"dateModified\":\"2020-09-08T00:00+01:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Faesel Saeed\",\"url\":\"https://www.faesel.com/about\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Faesel Saeed\",\"url\":\"https://www.faesel.com\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https://www.faesel.com/images/logo.png\"}},\"keywords\":\"grpc, .net, c#, asp.net, grpc-web, rest, nswag, proto-files, nuget, grpc-reflection, bloomrpc\",\"url\":\"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you\"}}"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"$10\"}}],[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BreadcrumbList\\\",\\\"itemListElement\\\":[{\\\"@type\\\":\\\"ListItem\\\",\\\"position\\\":1,\\\"name\\\":\\\"Home\\\",\\\"item\\\":\\\"https://www.faesel.com\\\"},{\\\"@type\\\":\\\"ListItem\\\",\\\"position\\\":2,\\\"name\\\":\\\"Blog\\\",\\\"item\\\":\\\"https://www.faesel.com/blog\\\"},{\\\"@type\\\":\\\"ListItem\\\",\\\"position\\\":3,\\\"name\\\":\\\".NET \u0026 GRPC What they forgot to tell you\\\",\\\"item\\\":\\\"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you\\\"}]}\"}}],[\"$\",\"article\",null,{\"className\":\"page-module__dgei_G__article\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/blog\",\"className\":\"page-module__dgei_G__backLink\",\"children\":\"‚Üê Back to Blog\"}],[\"$\",\"header\",null,{\"className\":\"page-module__dgei_G__header\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"page-module__dgei_G__title\",\"children\":\".NET \u0026 GRPC What they forgot to tell you\"}],[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__meta\",\"children\":[[\"$\",\"time\",null,{\"className\":\"page-module__dgei_G__date\",\"dateTime\":\"2020-09-08T00:00+01:00\",\"children\":[\"üìÖ \",\"September 7, 2020\"]}],[\"$\",\"span\",null,{\"className\":\"page-module__dgei_G__separator\",\"children\":\"‚Ä¢\"}],[\"$\",\"span\",null,{\"className\":\"page-module__dgei_G__readingTime\",\"children\":[\"‚è±Ô∏è \",\"9 min read\"]}]]}],[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__tags\",\"children\":[[\"$\",\"span\",\"grpc-0\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"grpc\"}],[\"$\",\"span\",\".net-1\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\".net\"}],[\"$\",\"span\",\"c#-2\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"c#\"}],[\"$\",\"span\",\"asp.net-3\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"asp.net\"}],[\"$\",\"span\",\"grpc-web-4\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"grpc-web\"}],[\"$\",\"span\",\"rest-5\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"rest\"}],[\"$\",\"span\",\"nswag-6\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"nswag\"}],[\"$\",\"span\",\"proto-files-7\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"proto-files\"}],[\"$\",\"span\",\"nuget-8\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"nuget\"}],[\"$\",\"span\",\"grpc-reflection-9\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"grpc-reflection\"}],[\"$\",\"span\",\"bloomrpc-10\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"bloomrpc\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__heroImage\",\"children\":[\"$\",\"$L11\",null,{\"src\":\"https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg\",\"alt\":\".NET \u0026 GRPC What they forgot to tell you\",\"fill\":true,\"className\":\"page-module__dgei_G__heroImageImg\",\"priority\":true,\"sizes\":\"(max-width: 800px) 100vw, 800px\"}]}],[\"$\",\"$L12\",null,{\"url\":\"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you\",\"title\":\".NET \u0026 GRPC What they forgot to tell you\",\"description\":\"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat\",\"variant\":\"sidebar\"}],\"$L13\",\"$L14\"]}]]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"title\",\"0\",{\"children\":\".NET \u0026 GRPC What they forgot to tell you | Tech Blog | FAESEL.COM\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat\"}],[\"$\",\"link\",\"2\",{\"rel\":\"author\",\"href\":\"https://www.faesel.com/about\"}],[\"$\",\"meta\",\"3\",{\"name\":\"author\",\"content\":\"Faesel Saeed\"}],[\"$\",\"meta\",\"4\",{\"name\":\"keywords\",\"content\":\"grpc,.net,c#,asp.net,grpc-web,rest,nswag,proto-files,nuget,grpc-reflection,bloomrpc\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\".NET \u0026 GRPC What they forgot to tell you\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:published_time\",\"content\":\"2020-09-08T00:00+01:00\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:site\",\"content\":\"@faeselsaeed\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:creator\",\"content\":\"@faeselsaeed\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\".NET \u0026 GRPC What they forgot to tell you\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image\",\"content\":\"https://images.ctfassets.net/wjg1udsw901v/5m1MwxccFfmDxkLKcq3dBt/b54fc31b09d0a266a3d8cd5082839976/grpc-logojpg.jpg\"}],[\"$\",\"link\",\"16\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",\"17\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",\"18\",{\"rel\":\"apple-touch-icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"$L15\",\"19\",{}]]\n"])</script><script>self.__next_f.push([1,"16:T8fa9,"])</script><script>self.__next_f.push([1,"\u003cp\u003eAs an engineer, I have always had a heavy reliance on REST\u0026#39;ful API\u0026#39;s for passing information between applications. With the introduction of \u003ca href=\"https://swagger.io/specification/\"\u003eopen API specification\u003c/a\u003e now in version 3.0.3, integration has never been easier. The push to break monoliths into microservices has further boosted its usage, however I always found one size never fits all.\u003c/p\u003e\n\u003ch2\u003eWhere REST falls down üëé\u003c/h2\u003e\n\u003cp\u003eRESTful services have many shortfalls built in, if you\u0026#39;re in my boat and most of the time your creating services and working on client applications. Having to tailor a client library to call those services has always been a tiresome task. 3rd party tooling like \u003ca href=\"https://github.com/RicoSuter/NSwag\"\u003eNswag\u003c/a\u003e made some attempt to fix this problem however I still find breaking changes between versions that make huge changesets across all your endpoints. If your working across multiple languages like C# and Javascript your work doubles up. \u003c/p\u003e\n\u003cp\u003eThere are also encumbrances experienced when mixing batch/bulk operations, overnight jobs with REST\u0026#39;ful APIs. Leading to complex solutions that auto scale or spread load over time. Having to go through each request-response cycle on bulk is just in-efficient.\u003c/p\u003e\n\u003cp\u003eIn most cases, responses are also in the form of JSON which is designed to cater for human readability at the expense of being inefficient. If you talking machine to machine readability is not a concern?  \u003c/p\u003e\n\u003cp\u003eLets also not mention those endless subjective PR threads trying to decide whats RESTful and whats not üòá.\u003c/p\u003e\n\u003ch2\u003eCan GRPC fill the gaps ü§∑‚Äç‚ôÇÔ∏è\u003c/h2\u003e\n\u003cp\u003eIf you experienced the REST\u0026#39;ful pains above, GRPC\u0026#39;s got your back. To get a quick demonstration of its capabilities, I recommend \u003ca href=\"http://wildermuth.com/2020/07/09/gRPC-Talk-at-netPonto\"\u003eShawn Wildermuth\u0026#39;s gRPC Talk at netPonto User Group (2020)\u003c/a\u003e he explains it in a easy to understand way.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=3wUtQb6C7to\"\u003ehttps://www.youtube.com/watch?v=3wUtQb6C7to\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTo sum up its capabilities it has two key differences to REST (if your already familiar with this, skip to section \u003cstrong\u003eThings to look into\u003c/strong\u003e).\u003c/p\u003e\n\u003ch3\u003e1. Proto files\u003c/h3\u003e\n\u003cp\u003eProto files contain the definition of your API in a structured spec compliant way. The code below shows a simple \u003cem\u003eGreetingsService\u003c/em\u003e with a basic request and response.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-attribute\"\u003esyntax\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;proto3\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003eoption csharp_namespace \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;HelloService\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003eservice GreetingsService {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    rpc GetHello (HelloRequest) returns (HelloResponse)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003emessage HelloRequest {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    int32 HelloCount \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003emessage HelloResponse {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    string HelloDescription \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eProto files can then be used to transpile code \u003ca href=\"https://grpc.io/docs/languages/\"\u003einto many languages\u003c/a\u003e. When transpiling we have the option to either create code for a \u003cstrong\u003eserver\u003c/strong\u003e or \u003cstrong\u003eclient\u003c/strong\u003e. Code generation creates a base class \u003cstrong\u003eGreetingsServiceBase\u003c/strong\u003e for us (it\u0026#39;s generated in the bin folder on build time). Eventually, you end up with a service that looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e Grpc.Core;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e HelloServer;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e System.Threading.Tasks;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003enamespace\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eTaxServer.Services\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eHelloGrpcService\u003c/span\u003e : \u003cspan class=\"hljs-title\"\u003eGreetingsService.GreetingsServiceBase\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e Task\u0026lt;HelloResponse\u0026gt; \u003cspan class=\"hljs-title\"\u003eGetHello\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eHelloRequest request, ServerCallContext context\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HelloResponse { HelloDescription = \u003cspan class=\"hljs-string\"\u003e$\u0026quot;\u003cspan class=\"hljs-subst\"\u003e{request.HelloCount}\u003c/span\u003e Hellos to you!\u0026quot;\u003c/span\u003e };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe act of sharing and distributing proto files means that consuming clients can easily create their own client code and be completely agnostic of language.\u003c/p\u003e\n\u003ch3\u003e2. Defining request/response lifecycle\u003c/h3\u003e\n\u003cp\u003eGRPC allows you to change its request/response lifecycle, it has 4 options described below,\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eUnary RPC\u0026#39;s\u003c/strong\u003e: Unary RPCs where the client sends a single request to the server and gets a single response back.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eServer Streaming RPC\u0026#39;s\u003c/strong\u003e: Server streaming RPCs where the client sends a request to the server and gets a stream to read a sequence of messages back.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eClient Streaming RPC\u0026#39;s\u003c/strong\u003e: Client streaming RPCs where the client writes a sequence of messages and sends them to the server, again using a provided stream.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBi-Directional Streaming RPC\u0026#39;s\u003c/strong\u003e: Bidirectional streaming RPCs where both sides send a sequence of messages using a read-write stream.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"https://grpc.io/docs/what-is-grpc/core-concepts/\"\u003e\u003cem\u003eTaken from GRPC.io\u003c/em\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThese additional modes are more suited for batch processing over your traditional request/response lifecycle.\u003c/p\u003e\n\u003ch2\u003eThings to look into ‚úÖ\u003c/h2\u003e\n\u003cp\u003eSo far so great, getting to this point is relatively easy and straightforward. Problem is all the tutorials seem to end at this point üòü. To have a live API several additional concerns need to be addressed. My list was as follows:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCheck how we can consume/distribute .proto files\u003c/li\u003e\n\u003cli\u003eHow to create a health checking probe for a GRPC service\u003c/li\u003e\n\u003cli\u003eHow to version endpoints\u003c/li\u003e\n\u003cli\u003eCan a .NET Framework client app consume a .NET Core GRPC server?\u003c/li\u003e\n\u003cli\u003eHow to debug with tools, call an endpoint\u003c/li\u003e\n\u003cli\u003eAuthentication and authorization\u003c/li\u003e\n\u003cli\u003eCan you call the service from a browser?\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3\u003e1. Check how we can consume/distribute .proto files\u003c/h3\u003e\n\u003cp\u003eThere are two different approaches to achieve this, mainly dependent on whether your service is internal or external public facing.\u003c/p\u003e\n\u003ch4\u003eOption 1 - With nuget packages\u003c/h4\u003e\n\u003cp\u003eOption one is to distribute your proto files using Nuget packages. This solution is recommended in the situation where you are using GRPC for internal services. Your solution structure would look something like this:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHelloService.Protos\u003cbr\u003e- Hello.protos\u003c/li\u003e\n\u003cli\u003eHelloService.Server\u003cbr\u003e- Server code ...\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIn this case we would use a Nuspec file to package the .protos and output it into the following structure in the client app. Considering you could be consuming more than one GRPC service it might make sense to create subfolders to know where the proto file comes from.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHelloClient\u003cbr\u003e/Protos/\u003cstrong\u003eservice name goes gere\u003c/strong\u003e/Hello.protos\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eFrom here the client application can generate its client service code using the protofile. If you want to go one step further there is a dotnet command you can use to integrate the proto file into the \u003cstrong\u003e.csproj\u003c/strong\u003e file using a \u003ca href=\"https://docs.microsoft.com/en-us/aspnet/core/grpc/dotnet-grpc?view=aspnetcore-3.1\"\u003edotnet command\u003c/a\u003e which can be triggered after the installation of the package.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003edotnet grpc\u003cspan class=\"hljs-built_in\"\u003e add-file \u003c/span\u003eHello.proto\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch4\u003eOption 2 - With a discovery endpoint\u003c/h4\u003e\n\u003cp\u003eThis approach is recommended if your GRPC service is a service meant for external consumers. The idea behind this approach is to expose which services/endpoints are available. The method is dependent on the \u003ca href=\"https://www.nuget.org/packages/Grpc.Reflection/\"\u003e\u003cstrong\u003eGrpc.Reflection\u003c/strong\u003e\u003c/a\u003e Nuget package.\u003c/p\u003e\n\u003cp\u003eThe general approach is outlined \u003ca href=\"https://github.com/grpc/grpc/blob/master/doc/csharp/server_reflection.md\"\u003ehere\u003c/a\u003e. \u003c/p\u003e\n\u003cp\u003eOnce implemented it allows you to use an endpoint from the server code to generate your client code. Dotnet has a \u003ca href=\"https://www.nuget.org/packages/dotnet-grpc-cli/\"\u003eGRPC CLI tool\u003c/a\u003e, that can read from a server reflection endpoint and produce a proto file out of it. The command looks like this,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003edotnet grpc-cli \u003cspan class=\"hljs-keyword\"\u003edump\u003c/span\u003e https:\u003cspan class=\"hljs-comment\"\u003e//localhost:5001 Reflection.HelloService\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYou can also write the proto file to disk using this command\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003edotnet grpc-cli dump http://localhost:10042 Reflection.HelloService -o ./prot\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003e2. How to create a health checking probe for a GRPC service\u003c/h3\u003e\n\u003cp\u003eHealth checking probe endpoints are useful for monitoring uptime as well as managing containers when services are unresponsive. GRPC specification has a defined structure for creating your health checking endpoint called the \u003ca href=\"https://github.com/grpc/grpc/blob/master/doc/health-checking.md\"\u003e\u003cstrong\u003eGRPC Health Checking Protocol\u003c/strong\u003e\u003c/a\u003e. \u003c/p\u003e\n\u003cp\u003eHowever, since we are using asp.net core we can get away from this and rely on middleware to do this for us with little code.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eConfigureServices\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(IServiceCollection services)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  services.\u003cspan class=\"hljs-built_in\"\u003eAddGrpc\u003c/span\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  services.\u003cspan class=\"hljs-built_in\"\u003eAddHealthChecks\u003c/span\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eConfigure\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(IApplicationBuilder app)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  app.\u003cspan class=\"hljs-built_in\"\u003eUseEndpoints\u003c/span\u003e(endpoints =\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    endpoints.\u003cspan class=\"hljs-built_in\"\u003eMapHealthChecks\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/healthz\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  });\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow when running locally \u003cstrong\u003e\u003ca href=\"https://localhost:5001/healthz\"\u003ehttps://localhost:5001/healthz\u003c/a\u003e\u003c/strong\u003e we can get a 200 response. Here is what the output logs look like:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Request starting HTTP/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e GET https:\u003cspan class=\"hljs-comment\"\u003e//localhost:5001/healthz\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Routing\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.EndpointMiddleware\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[0]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Executing endpoint \u003cspan class=\"hljs-string\"\u003e\u0026#x27;Health checks\u0026#x27;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Routing\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.EndpointMiddleware\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[1]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Executed endpoint \u003cspan class=\"hljs-string\"\u003e\u0026#x27;Health checks\u0026#x27;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Hosting\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Diagnostics\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[2]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Request finished \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e19.056ms\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e text/plain\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003e3. How to version endpoints\u003c/h3\u003e\n\u003cp\u003eThe problem of versioning is easily solved using namespaces, it\u0026#39;s just a case of incorporating your version number into the namespace like so,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003eoption csharp_namespace \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;HelloService.v1\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eFor each version, you would have different proto files and different service implementations. When inheriting from the base we can be specific on the version we need.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eServer Code\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003epublic \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eHelloGrpcService\u003c/span\u003e\u003cspan class=\"hljs-attr\"\u003e : HelloService\u003c/span\u003e.\u003cspan class=\"hljs-title\"\u003ev1\u003c/span\u003e.\u003cspan class=\"hljs-title\"\u003eGreetingsService\u003c/span\u003e.\u003cspan class=\"hljs-title\"\u003eGreetingsServiceBase\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cstrong\u003eClient Code\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThe namespaces segregate the types so it just works out.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-comment\"\u003e//Version 1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e channel = GrpcChannel.ForAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://localhost:5001\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclient\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HelloService.v1.GreetingsService.GreetingsServiceClient(channel);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e response = await \u003cspan class=\"hljs-keyword\"\u003eclient\u003c/span\u003e.GetHello(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HelloService.v1.HelloRequest() { \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      HelloCount = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-comment\"\u003e//Version 2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e channel2 = GrpcChannel.ForAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://localhost:5001\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e client2 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HelloService.v2.GreetingsService.GreetingsServiceClient(channel);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e response2 = await client2.GetHello(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HelloService.v2.HelloRequest() {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      HelloCount = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e});\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003e4. Can a .NET Framework client app consume a .NET Core GRPC server?\u003c/h3\u003e\n\u003cp\u003eTurns out it can yes, however ... as GRPC is built upon HTTP/2 which is not supported in .net framework, making secure connections to your API is not possible. The client code for .net framework is very similar, we just pass a \u003cstrong\u003eChannelCredentials.Insecure\u003c/strong\u003e option in when building the client.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e channel = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Channel(\u003cspan class=\"hljs-string\"\u003e\u0026quot;127.0.0.1\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e, ChannelCredentials.Insecure);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclient\u003c/span\u003e = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e GreetingsService.GreetingsServiceClient(channel);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003e5. How to debug with tools, call an endpoint\u003c/h3\u003e\n\u003cp\u003eIf you\u0026#39;re like me and you\u0026#39;ve come from a REST background your most likely used to polished tools like Postman or Insomnia to test out your endpoints. Sadly these tools don\u0026#39;t support GRPC üò¢... yet anyway...\u003c/p\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/grpc-ecosystem/awesome-grpc#lang-cs\"\u003eGRPC Tooling Community\u003c/a\u003e is still in its infancy. There are however some new players that are emerging that get the job done, most notably for me BloomRPC. \u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"//images.ctfassets.net/wjg1udsw901v/6p6bGkCU7Tpa3tMwPsoRxO/adb23285ed92ea9c2c757ef62a4600a9/BloomRPC.png\" alt=\"BloomRPC\"\u003e\u003c/p\u003e\n\u003cp\u003eAfter importing in your proto files you get a great swagger-esk UI that automatically build up your request body from your proto file.\u003c/p\u003e\n\u003ch3\u003e6. Authentication and authorization\u003c/h3\u003e\n\u003cp\u003eBecause we are working under the guise of asp.net core we can take advantage of its authentication middleware. The following authentication methods are supported.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAzure Active Directory\u003c/li\u003e\n\u003cli\u003eClient Certificate\u003c/li\u003e\n\u003cli\u003eIdentityServer\u003c/li\u003e\n\u003cli\u003eJWT Token\u003c/li\u003e\n\u003cli\u003eOAuth 2.0\u003c/li\u003e\n\u003cli\u003eOpenID Connect\u003c/li\u003e\n\u003cli\u003eWS-Federation\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBelow is a simple code example of authenticating a JWT token with an identity service. As you can see its no different from a REST service.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e ConfigureServices(IServiceCollection services)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    var authority = \u003cspan class=\"hljs-string\"\u003e\u0026quot;https://myidentityserver.com\u0026quot;\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    services\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        .AddAuthentication(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Bearer\u0026quot;\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        .AddJwtBearer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Bearer\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e =\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.Authority = authority;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.RequireHttpsMetadata = \u003cspan class=\"hljs-keyword\"\u003efalse\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.TokenValidationParameters = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e TokenValidationParameters\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                ValidateAudience = \u003cspan class=\"hljs-keyword\"\u003efalse\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.ConfigurationManager = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ConfigurationManager\u0026lt;OpenIdConnectConfiguration\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            (\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                metadataAddress: authority + \u003cspan class=\"hljs-string\"\u003e\u0026quot;/.well-known/openid-configuration\u0026quot;\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                configRetriever: \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e OpenIdConnectConfigurationRetriever(),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                docRetriever: \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HttpDocumentRetriever { RequireHttps = \u003cspan class=\"hljs-keyword\"\u003efalse\u003c/span\u003e }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            );\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e21\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.Events = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JwtBearerEvents\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e22\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e23\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                OnTokenValidated = context =\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e24\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e25\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    var ci = (ClaimsIdentity)context.Principal.Identity;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e26\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    var authHeader = context.Request.Headers[\u003cspan class=\"hljs-string\"\u003e\u0026quot;Authorization\u0026quot;\u003c/span\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e27\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    var token = authHeader.FirstOrDefault()?.Substring(\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e28\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (token != \u003cspan class=\"hljs-keyword\"\u003enull\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e29\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e30\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                        ci.AddClaim(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Claim(\u003cspan class=\"hljs-string\"\u003e\u0026quot;token\u0026quot;\u003c/span\u003e, token));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e31\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e32\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e33\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTask\u003c/span\u003e.CompletedTask;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e34\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e35\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e36\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        });\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e37\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e38\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    services.AddAuthorization();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e39\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e40\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e41\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e42\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e Configure(IApplicationBuilder app)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e43\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e44\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    app.UseAuthentication();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e45\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    app.UseAuthorization();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e46\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e47\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBelow is output from an authenticated request:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Request starting HTTP/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e POST https:\u003cspan class=\"hljs-comment\"\u003e//localhost:5001/HelloGrpcService.GreetingsService/GetHello application/grpc\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Authentication\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.JwtBearer\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.JwtBearerHandler\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[2]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Successfully validated the token.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Authorization\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.DefaultAuthorizationService\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[1]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Authorization was successful.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Routing\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.EndpointMiddleware\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[0]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Executing endpoint \u003cspan class=\"hljs-string\"\u003e\u0026#x27;gRPC - /HelloGrpcService.GreetingsService/GetHello\u0026#x27;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003eRequest parameter \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003eRequest came from test-client-id\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Routing\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.EndpointMiddleware\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[1]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Executed endpoint \u003cspan class=\"hljs-string\"\u003e\u0026#x27;gRPC - /HelloGrpcService.GreetingsService/GetHello\u0026#x27;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003einfo: Microsoft\u003cspan class=\"hljs-selector-class\"\u003e.AspNetCore\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Hosting\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.Diagnostics\u003c/span\u003e\u003cspan class=\"hljs-selector-attr\"\u003e[2]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      Request finished \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5865.2411ms\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e application/grpc\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003e7. Can you call the service from a browser?\u003c/h3\u003e\n\u003cp\u003eCurrently, as it stands the answer is no, browsers don\u0026#39;t offer fine-grained control over API requests to support GRPC. However, there is some light at the end of the tunnel.\u003c/p\u003e\n\u003cp\u003eBack in 2016 Google started working on a specification for \u0026quot;GRPC for the browser\u0026quot;. You can read more about it \u003ca href=\"https://grpc.io/blog/state-of-grpc-web/\"\u003ehere\u003c/a\u003e but in essence,\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe basic idea is to have the browser send normal HTTP requests (with Fetch or XHR) and have a small proxy in front of the gRPC server to translate the requests and responses to something the browser can use - grpc.io\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIn the C# world, Microsoft has an implementation of this specification in their docs, \u003ca href=\"https://docs.microsoft.com/en-gb/aspnet/core/grpc/browser?view=aspnetcore-3.1\"\u003eUse gRPC in browser apps\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThere are some disclaimers to this, as gRPC supports streaming and bidirectional requests this addition is only recommended for unary requests. Due to this limiting factor helpers are present to turn it on and off for services when setting up GRPC services in the startup,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003eendpoints\u003cspan class=\"hljs-selector-class\"\u003e.MapGrpcService\u003c/span\u003e\u0026lt;HelloGrpcService\u0026gt;()\u003cspan class=\"hljs-selector-class\"\u003e.EnableGrpcWeb\u003c/span\u003e()\u003cspan class=\"hljs-selector-class\"\u003e.RequireCors\u003c/span\u003e(\u0026quot;AllowAll\u0026quot;);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eWhat I find particularly interesting is that the problem grpc-web solves is similar to the problems we have with .net framework (https/2 is not supported). Could this perhaps be an answer to getting secure requests working? ... sadly not yet! at the moment its not possible as grpc-web was was built on .net standard 2.1 so .net framework is not supported. Perhaps there might be movement on this in time to come.\u003c/p\u003e\n\u003ch2\u003eThings I missed out\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003eIntegration Testing, im a big fan of using in memory testing with Test Server it would be interesting to see if this works with a GRPC service.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eUseful Links\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/grpc/grpc/tree/master/src/csharp\"\u003eC# Examples\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/grpc/grpc-dotnet/tree/master/examples\"\u003eMore c# examples\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n"])</script><script>self.__next_f.push([1,"13:[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$16\"}}]\n14:[\"$\",\"$L12\",null,{\"url\":\"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you\",\"title\":\".NET \u0026 GRPC What they forgot to tell you\",\"description\":\"As an engineer, I have always had a heavy reliance on REST'ful API's for passing information between applications. With the introduction of [open API specificat\"}]\n"])</script></body></html>