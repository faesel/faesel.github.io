1:"$Sreact.fragment"
3:I[22016,["/_next/static/chunks/8be72f203fe36d6f.js"],""]
4:I[5500,["/_next/static/chunks/8be72f203fe36d6f.js"],"Image"]
8:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/708205fa81a1891d.js"],"OutletBoundary"]
9:"$Sreact.suspense"
:HL["/_next/static/chunks/bc2ec6988ea822be.css","style"]
2:T430,{"@context":"https://schema.org","@type":"BlogPosting","headline":"Electron & New Relic Integration Using Open Telemetry","description":"\n# Introduction\n\nRecently I encountered a scenario where I needed to integrate New Relic into my Electron application. New Relic supports a number of integratio","image":"https://images.ctfassets.net/wjg1udsw901v/4N5m97m5WfdJi5u7D8I4tX/00d1a21ab7ce8db54af5fa6f84f89e9d/article-banner.jpg","datePublished":"2023-03-17T00:00+00:00","dateModified":"2023-03-17T00:00+00:00","author":{"@type":"Person","name":"Faesel Saeed","url":"https://www.faesel.com/about"},"publisher":{"@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com","logo":{"@type":"ImageObject","url":"https://www.faesel.com/images/logo.png"}},"keywords":"electron, new-relic, open-telemetry, tracing, logging, jaeger, otlp, ipc-channel","url":"https://www.faesel.com/blog/electron-newrelic-integration-using-open-telemetry","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.faesel.com/blog/electron-newrelic-integration-using-open-telemetry"}}5:T746c,<h1>Introduction</h1>
<p>Recently I encountered a scenario where I needed to integrate New Relic into my Electron application. New Relic supports a number of integration types our the box, some of the more heavily used ones are,</p>
<ul>
<li>APM Agents - Primary used for backend tracking, most of the documentation will point to integrating in this style.</li>
<li>Browser Agent - Used for front end client side logging.</li>
</ul>
<p>Integrating the browser agent was a simple task of adding a logging script to the HTML page hosting the app ... easy so far. Because Electron is effectively loading up a chromium browser, the browser agent should work as normal. The APM Agent on the other hand was a different story, after having scoured the internet I found that its currently not supported with Electron. In fact if you look at the documentation for Electron, there is a suspicious absence of logging documentation. This might be down to the unique way Electrons IPC channels (inter-process-communication, allows for backend and front end communication using an event based model) work.</p>
<p>Due to this I knew we would require a manual approach to logging, this is where Open Telemetry comes into play. Using Open Telemetry we can bootstrap the app on startup and start manually adding tracing logs in any backend IPC handler. Since most logging providers now support Open Telemetry, including New Relic we have a mechanism to export out logs out.</p>
<p>This article was created as a complete guide to the approach mentioned above. Due to the lack of examples and documentation online I hope this article comes in use for someone. In the example below I was using Electron with Vite and Typescript.</p>
<h1>Installing Dependencies</h1>
<p>To get started open telemetry has a couple of packages that need installing,</p>
<pre><code class="hljs language-bash"><span class="code-line"><span class="line-number">1</span><span class="line-content">npm install @opentelemetry/api</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">npm install @opentelemetry/auto-instrumentations-node</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">npm install @opentelemetry/exporter-trace-otlp-http</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">npm install @opentelemetry/instrumentation</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">npm install @opentelemetry/resources</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">npm install @opentelemetry/semantic-conventions</span></span></code></pre><h1>Bootstrapping the App</h1>
<p>The first step to integration is to connect into the startup process of Electron and instrument our Open Telemetry tracer. As Open Telemetry allows you to export your logs to multiple 3rd parties the example below will first show you how to get started with Jaeger an open source tracing sink and then expand this to New Relic.</p>
<h2>Hooking into Startup</h2>
<p>The first part of coding is to hook into the startup process your application. Electron conveniently has a <code>whenReady()</code> function that is called when electron has finished initialising. We can make use of this function to register our tracer.</p>
<p>Let&#39;s first start by creating a <code>tracing.ts</code> file in the root of the application. In this file we will have two functions, one to register a tracer and another to get the tracer. We are also going to pass through some useful information to the tracer like the application version, and operating system so that all our logs have some base information they can relay back to New Relic.</p>
<pre><code class="hljs language-javascript"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> registerTracer = (<span class="hljs-attr">appVersion</span>: string, <span class="hljs-attr">operatingSystem</span>: string): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">	<span class="hljs-comment">//Registration code here</span></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getTracer = (): <span class="hljs-function"><span class="hljs-params">Tracer</span> =&gt;</span> {</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">	<span class="hljs-comment">//Code to get tracer here</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">}</span></span></code></pre><p>Next we can call the register function on startup,</p>
<pre><code class="hljs language-javascript"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">import</span> { app } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;electron&quot;</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">app.<span class="hljs-title function_">whenReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">	<span class="hljs-comment">//For me this is the version defined in my package.json</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">	<span class="hljs-keyword">const</span> appVersion = app.<span class="hljs-title function_">getVersion</span>();</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">	<span class="hljs-comment">//Part of NodeJS&#x27;s way of detirmining the platform</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">	<span class="hljs-keyword">const</span> operatingSystem = process.<span class="hljs-property">platform</span>;</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">	<span class="hljs-title function_">registerTracer</span>(appVersion, operatingSystem);</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">});</span></span></code></pre><h2>Configuring the Tracer</h2>
<p>Now that we have some functions to hook into we can flesh them out with our configuration. For ease of copy and paste im going to first code dump and the file then explain each part.</p>
<pre><code class="hljs language-javascript"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-comment">/*tracing.ts*/</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BatchSpanProcessor</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/sdk-trace-base&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Resource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/resources&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">SemanticResourceAttributes</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/semantic-conventions&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content"><span class="hljs-keyword">import</span> {</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">  <span class="hljs-title class_">NodeTracerProvider</span>,</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">  <span class="hljs-title class_">SimpleSpanProcessor</span>,</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/sdk-trace-node&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"><span class="hljs-keyword">import</span> { registerInstrumentations } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/instrumentation&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">OTLPTraceExporter</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/exporter-trace-otlp-http&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content"><span class="hljs-keyword">import</span> opentelemetry, { <span class="hljs-title class_">Tracer</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/api&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content"><span class="hljs-keyword">import</span> { getNodeAutoInstrumentations } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@opentelemetry/auto-instrumentations-node&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">NEWRELIC_APP_NAME</span> = <span class="hljs-string">&quot;APP NAME GOES HERE&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">IS_DEVELOPMENT</span> = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">DEV</span>;</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> registerTracer = (<span class="hljs-attr">appVersion</span>: string, <span class="hljs-attr">operatingSystem</span>: string): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">  <span class="hljs-title function_">registerInstrumentations</span>({</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">    <span class="hljs-attr">instrumentations</span>: [</span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">      <span class="hljs-title function_">getNodeAutoInstrumentations</span>(),</span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">      <span class="hljs-comment">//<span class="hljs-doctag">TODO:</span> Add an instrumentation library here when electron is supported</span></span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content">    ],</span></span>
<span class="code-line"><span class="line-number">24</span><span class="line-content">  });</span></span>
<span class="code-line"><span class="line-number">25</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">26</span><span class="line-content">  <span class="hljs-keyword">const</span> resource = <span class="hljs-title class_">Resource</span>.<span class="hljs-title function_">default</span>().<span class="hljs-title function_">merge</span>(</span></span>
<span class="code-line"><span class="line-number">27</span><span class="line-content">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Resource</span>({</span></span>
<span class="code-line"><span class="line-number">28</span><span class="line-content">      [<span class="hljs-title class_">SemanticResourceAttributes</span>.<span class="hljs-property">SERVICE_NAME</span>]: <span class="hljs-variable constant_">NEWRELIC_APP_NAME</span>,</span></span>
<span class="code-line"><span class="line-number">29</span><span class="line-content">      [<span class="hljs-title class_">SemanticResourceAttributes</span>.<span class="hljs-property">SERVICE_VERSION</span>]: appVersion,</span></span>
<span class="code-line"><span class="line-number">30</span><span class="line-content">      [<span class="hljs-title class_">SemanticResourceAttributes</span>.<span class="hljs-property">OS_NAME</span>]: operatingSystem,</span></span>
<span class="code-line"><span class="line-number">31</span><span class="line-content">    })</span></span>
<span class="code-line"><span class="line-number">32</span><span class="line-content">  );</span></span>
<span class="code-line"><span class="line-number">33</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">34</span><span class="line-content">  <span class="hljs-keyword">const</span> provider = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NodeTracerProvider</span>({</span></span>
<span class="code-line"><span class="line-number">35</span><span class="line-content">    <span class="hljs-attr">resource</span>: resource,</span></span>
<span class="code-line"><span class="line-number">36</span><span class="line-content">  });</span></span>
<span class="code-line"><span class="line-number">37</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">38</span><span class="line-content">  <span class="hljs-keyword">const</span> otlpExporter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OTLPTraceExporter</span>({</span></span>
<span class="code-line"><span class="line-number">39</span><span class="line-content">	<span class="hljs-comment">//Jaeger tracing url</span></span></span>
<span class="code-line"><span class="line-number">40</span><span class="line-content">	<span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://localhost:4318/v1/traces&#x27;</span></span></span>
<span class="code-line"><span class="line-number">41</span><span class="line-content">  });</span></span>
<span class="code-line"><span class="line-number">42</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">43</span><span class="line-content">  <span class="hljs-keyword">const</span> processor = <span class="hljs-variable constant_">IS_DEVELOPMENT</span></span></span>
<span class="code-line"><span class="line-number">44</span><span class="line-content">    ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleSpanProcessor</span>(otlpExporter)</span></span>
<span class="code-line"><span class="line-number">45</span><span class="line-content">    : <span class="hljs-keyword">new</span> <span class="hljs-title class_">BatchSpanProcessor</span>(otlpExporter);</span></span>
<span class="code-line"><span class="line-number">46</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">47</span><span class="line-content">  provider.<span class="hljs-title function_">addSpanProcessor</span>(processor);</span></span>
<span class="code-line"><span class="line-number">48</span><span class="line-content">  provider.<span class="hljs-title function_">register</span>();</span></span>
<span class="code-line"><span class="line-number">49</span><span class="line-content">};</span></span></code></pre><p><em>Note <code>import.meta.env</code> is just Vite&#39;s way of getting hold of environment variables.</em></p>
<p>You might firstly notice that there is a <code>TODO</code> in the code, if and when Electron supports a plugin style integration with open telemetry, the <code>instrumentations</code> array will be the place to add it. For now we are manually instrumenting the app.</p>
<p>The resources section is given to use using the <code>@opentelemetry/resources</code> and <code>@opentelemetry/semantic-conventions</code> packages. It allows us to define some base properties we want to show in all our tracing logs. Obvious things like the app version, and operating systems (especially if your targeting multiple systems) are really useful bits of information to add. There are also some built in attributes for Kubernetes and oddly enough AWS (with some generic ones for other cloud providers).</p>
<p>In terms of the <code>OTLPTraceExporter</code> block, as we opted to do our tracing using HTTP (GRPC is also an option) with the package <code>@opentelemetry/exporter-trace-otlp-http</code> i have added some basic settings for Jaeger. Note that you can add a number of exporters here, and we will also be extending this to include New Relic.</p>
<p>The final part in question is the processors themselves, open telemetry has a few options on how you might want to push your logs to 3rd parties. Ive opted to use a <code>SimpleSpanProcessor</code> when running the app locally so that my logs are immediately pushed to the servers when testing things out. However in production im making use of a <code>BatchSpanProcessor</code> that batches a group of logs and then pushes them in one go. This helps reduce network traffic of the app.</p>
<h2>Exposing a Tracer</h2>
<p>In order to get an actual tracer we can get an instance from the global tracing provider using the <code>getTracer()</code> function. This tracer object then allows us to create logs in the shape of a <code>snap</code>. It is advised to call <code>getTracer</code> every time you need to start logging as opposed to maintaining your own instance.</p>
<pre><code class="hljs language-javascript"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">GetTracer</span> = () : <span class="hljs-function"><span class="hljs-params">Tracer</span> =&gt;</span> {</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">  <span class="hljs-keyword">return</span> opentelemetry.<span class="hljs-property">trace</span>.<span class="hljs-title function_">getTracer</span>(<span class="hljs-variable constant_">NEWRELIC_APP_NAME</span>);</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">}</span></span></code></pre><h1>Adding a Tracing Example</h1>
<p>Now that we have added all our logging code we can finally create an actual log entry. To do this we can create a new span, in which we can raise new events and record exceptions. In the example below i&#39;ve added some logging to an IPC handler.</p>
<pre><code class="hljs language-javascript"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">import</span> { ipcMain } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;electron&#x27;</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">GetTracer</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./tracing&#x27;</span></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"><span class="hljs-keyword">const</span> <span class="hljs-title function_">createWindow</span> = (<span class="hljs-params"></span>) =&gt; {</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">	<span class="hljs-comment">//Create new browser window</span></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">	ipcMain.<span class="hljs-title function_">handle</span>(<span class="hljs-string">&quot;getDinosaurs&quot;</span>, <span class="hljs-title function_">async</span> () =&gt; {</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">		<span class="hljs-keyword">await</span> <span class="hljs-title class_">GetTracer</span>().<span class="hljs-title function_">startActiveSpan</span>(<span class="hljs-string">&quot;getDinosaurs&quot;</span>, <span class="hljs-title function_">async</span> (span) =&gt; {</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">			<span class="hljs-comment">//await getDinosaurs()</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">			<span class="hljs-comment">//Record one or many events in your code blocks</span></span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">			span.<span class="hljs-title function_">addEvent</span>(<span class="hljs-string">&quot;receivedDinosaur&quot;</span>, { <span class="hljs-attr">name</span>: dinoName  });</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">			<span class="hljs-comment">//Record exceptions in your code block</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">			span.<span class="hljs-title function_">recordException</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Ops their all extinct!`</span>));</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">			span.<span class="hljs-title function_">end</span>();</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">		});</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">	});</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">}</span></span></code></pre><h1>Testing with Jaeger</h1>
<p>To test this out with Jaeger you can first execute the following docker command to create a new instance of Jaeger with OTLP enabled.</p>
<pre><code class="hljs language-bash"><span class="code-line"><span class="line-number">1</span><span class="line-content">docker run -d --name jaeger \</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">  -e COLLECTOR_ZIPKIN_HOST_PORT=:9411 \</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">  -e COLLECTOR_OTLP_ENABLED=<span class="hljs-literal">true</span> \</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">  -p 6831:6831/udp \</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">  -p 6832:6832/udp \</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">  -p 5778:5778 \</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">  -p 16686:16686 \</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">  -p 4317:4317 \</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">  -p 4318:4318 \</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">  -p 14250:14250 \</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">  -p 14268:14268 \</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">  -p 14269:14269 \</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">  -p 9411:9411 \</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">  jaegertracing/all-in-one:latest</span></span></code></pre><p>Once up and running you can navigate to the default UI url <a href="http://localhost:16686/">http://localhost:16686/</a> to start viewing your logs. It order to get something showing up you will need to run the app and begin pushing some logs to Jaeger.</p>
<h1>Setting up New Relic</h1>
<p>Everything is now setup from a code perspective, its time to create everything we need in New Relic. This step is quite quick and painless, a new key can be created from the API Keys section. Once there follow the <strong>Create a Key</strong> button. The form requires the following,</p>
<ul>
<li>Account - Set this to whatever you want</li>
<li>Key Type - Set this to <strong>Ingest - Licence</strong></li>
<li>Name - Set this to whatever you want, however it does make sense to match this up with the service name set in the section &quot;Configuring the Tracer&quot;</li>
</ul>
<p><img src="//images.ctfassets.net/wjg1udsw901v/3Eg3DL2escQx6jZdQsZYBQ/973a748bad74f91ecac6bd711f31f37a/new-relic-adding-new-api-key.png" alt="new-relic-adding-new-api-key"></p>
<p>Once thats created you should get an option to copy the key which is passed into your <code>OTLPTraceExporter</code>. As for the URL you can find New Relics OTLP endpoints on this <a href="https://docs.newrelic.com/docs/more-integrations/open-source-telemetry-integrations/opentelemetry/get-started/opentelemetry-set-up-your-app/">link</a>. Now that we have the settings needed we can change the <code>OTLPTraceExporter</code> to include the New Relic settings.</p>
<pre><code class="hljs language-javascript"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">const</span> otlpExporter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OTLPTraceExporter</span>({</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">	<span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://otlp.nr-data.net:443&#x27;</span>,</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">	<span class="hljs-attr">headers</span>: {</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">	  <span class="hljs-string">&quot;api-key&quot;</span>: <span class="hljs-string">`API KEY GOES HERE`</span>,</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">	},</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">});</span></span></code></pre><p>Once setup you will need to send your first log before anything appears in New Relic. Once you have results will show up in APM &amp; Services &gt; Services - OpenTelemetry &gt; Click on your app name &gt; Distributed Tracing. You can drill down to view the span events and attributes.</p>
<p>New Relic also has a second method of viewing your logs through the use of NRQL queries. You can query your data by visiting <strong>Query Your Data</strong> and entering the following query,</p>
<pre><code class="hljs language-sql"><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">FROM</span> SpanEvent <span class="hljs-keyword">WHERE</span> span.id <span class="hljs-keyword">IN</span> ( </span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">	<span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> Span <span class="hljs-keyword">WHERE</span> otel.library.name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;YOUR APP NAME HERE&#x27;</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">)</span></span></code></pre><p>And thats it, hope this was useful for someone! Before you get integrating note that there might be some logging providers that have a much easier integration with New Relic, <a href="https://docs.sentry.io/platforms/javascript/guides/electron/">sentry.io</a> seems like one of them.</p>
0:{"buildId":"GRQ4Wn3Dp8FngowyVAxrt","rsc":["$","$1","c",{"children":[[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"$2"}}],["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BreadcrumbList\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.faesel.com\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Blog\",\"item\":\"https://www.faesel.com/blog\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"Electron & New Relic Integration Using Open Telemetry\",\"item\":\"https://www.faesel.com/blog/electron-newrelic-integration-using-open-telemetry\"}]}"}}],["$","article",null,{"className":"page-module__dgei_G__article","children":[["$","$L3",null,{"href":"/blog","className":"page-module__dgei_G__backLink","children":"‚Üê Back to Blog"}],["$","header",null,{"className":"page-module__dgei_G__header","children":[["$","h1",null,{"className":"page-module__dgei_G__title","children":"Electron & New Relic Integration Using Open Telemetry"}],["$","div",null,{"className":"page-module__dgei_G__meta","children":["$","time",null,{"className":"page-module__dgei_G__date","dateTime":"2023-03-17T00:00+00:00","children":["üìÖ ","March 17, 2023"]}]}],["$","div",null,{"className":"page-module__dgei_G__tags","children":[["$","span","electron-0",{"className":"page-module__dgei_G__tag","children":"electron"}],["$","span","new-relic-1",{"className":"page-module__dgei_G__tag","children":"new-relic"}],["$","span","open-telemetry-2",{"className":"page-module__dgei_G__tag","children":"open-telemetry"}],["$","span","tracing-3",{"className":"page-module__dgei_G__tag","children":"tracing"}],["$","span","logging-4",{"className":"page-module__dgei_G__tag","children":"logging"}],["$","span","jaeger-5",{"className":"page-module__dgei_G__tag","children":"jaeger"}],["$","span","otlp-6",{"className":"page-module__dgei_G__tag","children":"otlp"}],["$","span","ipc-channel-7",{"className":"page-module__dgei_G__tag","children":"ipc-channel"}]]}]]}],["$","div",null,{"className":"page-module__dgei_G__heroImage","children":["$","$L4",null,{"src":"https://images.ctfassets.net/wjg1udsw901v/4N5m97m5WfdJi5u7D8I4tX/00d1a21ab7ce8db54af5fa6f84f89e9d/article-banner.jpg","alt":"Electron & New Relic Integration Using Open Telemetry","fill":true,"className":"page-module__dgei_G__heroImageImg","priority":true,"sizes":"(max-width: 800px) 100vw, 800px"}]}],["$","div",null,{"className":"page-module__dgei_G__content","dangerouslySetInnerHTML":{"__html":"$5"}}]]}]],["$L6"],"$L7"]}],"loading":null,"isPartial":false}
6:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/bc2ec6988ea822be.css","precedence":"next"}]
7:["$","$L8",null,{"children":["$","$9",null,{"name":"Next.MetadataOutlet","children":"$@a"}]}]
a:null
