1:"$Sreact.fragment"
3:I[22016,["/_next/static/chunks/8be72f203fe36d6f.js"],""]
4:I[5500,["/_next/static/chunks/8be72f203fe36d6f.js"],"Image"]
8:I[97367,["/_next/static/chunks/ff1a16fafef87110.js","/_next/static/chunks/708205fa81a1891d.js"],"OutletBoundary"]
9:"$Sreact.suspense"
:HL["/_next/static/chunks/bc2ec6988ea822be.css","style"]
2:T423,{"@context":"https://schema.org","@type":"BlogPosting","headline":"My journey of creating a .NET CLI tool","description":"# Why I started building a CLI\n\nAs a .NET engineer, I work with Azure storage a lot, its versatility, ease of use, as well as cost makes it a common staple amon","image":"https://images.ctfassets.net/wjg1udsw901v/5nkhsfNMJDJ5NGcAfvQ2Lt/a2ac18006da7a4865044b77365b55987/AzLazy.png","datePublished":"2020-12-18T00:00+00:00","dateModified":"2020-12-18T00:00+00:00","author":{"@type":"Person","name":"Faesel Saeed","url":"https://www.faesel.com/about"},"publisher":{"@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com","logo":{"@type":"ImageObject","url":"https://www.faesel.com/images/logo.png"}},"keywords":"cli, azure, queues, table-storage, containers, blob, azure-storage, dotnet-tools, az-lazy, console, commandline","url":"https://www.faesel.com/blog/my-journey-of-creating-a-dotnet-cli-tool","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.faesel.com/blog/my-journey-of-creating-a-dotnet-cli-tool"}}5:T9f61,<h1>Why I started building a CLI</h1>
<p>As a .NET engineer, I work with Azure storage a lot, its versatility, ease of use, as well as cost makes it a common staple amongst developers. Its application is also widespread from leveraging queues on a basic console app to storing uploaded images from a web application.</p>
<p>Typically as an engineer, I have always interfaced with azure storage using <a href="https://azure.microsoft.com/en-gb/features/storage-explorer/#features">Azure Storage Manager</a>, but as a UI tool, its always been two clicks away from the information I need or was just slow to navigate. </p>
<p>So I ended up taking my destiny into my own hands and built a CLI tool called <a href="https://github.com/faesel/az-lazy">Az-Lazy</a>.</p>
<h1>Packages used when I started</h1>
<p>So as with all projects, I started with a shopping list of packages I wanted to use/needed to make a great CLI experience. </p>
<h3>1. <a href="https://github.com/commandlineparser/commandline">CommandLineParser</a></h3>
<p>Whilst there are many command parsers on the market, I found this implementation particular nice to use. The end result allows you to to get a command pattern similar to most of the Microsoft dotnet tools,  <code>azlazy connection --list</code>.</p>
<p>Defining available commands is as easy as decorating a class with attributes, and the help options for each command is automatically generated for you (azlazy addcontainer --help).</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">[Verb(&quot;addcontainer&quot;, HelpText = &quot;Creates a new storage container&quot;)]</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">    <span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> AddContainerOptions : ICommandOptions</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">        [<span class="hljs-keyword">Option</span>(<span class="hljs-string">&#x27;n&#x27;</span>, &quot;name&quot;, Required = <span class="hljs-keyword">true</span>, HelpText = &quot;Name of the container to create&quot;)]</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">        <span class="hljs-built_in">public</span> string <span class="hljs-type">Name</span> { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        [<span class="hljs-keyword">Option</span>(<span class="hljs-string">&#x27;p&#x27;</span>, &quot;publicAccess&quot;, Required = <span class="hljs-keyword">false</span>, HelpText = &quot;Options are None, Blob, BlobContainer&quot;)]</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        <span class="hljs-built_in">public</span> string PublicAccess { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">    }</span></span></code></pre><h3>2. <a href="https://github.com/silkfire/Pastel">Pastel</a></h3>
<p>Splash of colour is always a sign of a great CLI experience and seeing red or green are key indicators of successful execution of a command. <em>Pastel</em> lets you do exactly that! its got a range of preset vibrant colours to choose from and allows you to easily RGB your console output. </p>
<p>The extension method style syntax is also great and doesn&#39;t distract you away from the code.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-string">&quot;You successfully deleted all your data&quot;</span>.Pastel(Color.LightGreen)<span class="hljs-comment">;</span></span></span></code></pre><h3>3. <a href="https://github.com/khalidabuhakmeh/ConsoleTables">ConsoleTables</a></h3>
<p>As Az-Lazy deals with table storeage, it was only a matter of time till i needed to output a table to the console. After a quick search on Nuget Gallery <em>ConsoleTables</em> showed up. With a simple minimilist table implementation it was quick to get setup,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">var table = <span class="hljs-built_in">new</span> ConsoleTable(&quot;Id&quot;, &quot;Blob&quot;, &quot;Size&quot;);</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">table</span>.AddRow(<span class="hljs-number">1</span>, &quot;dinopic1.jpg&quot;, <span class="hljs-number">300</span>)</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">     .AddRow(<span class="hljs-number">2</span>, &quot;dinopic2.jpb&quot;, <span class="hljs-number">450</span>);</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content"><span class="hljs-keyword">table</span>.<span class="hljs-keyword">Write</span>();</span></span></code></pre><p>However, I later had to drop this package for something slightly more advanced (Alba.CsConsoleFormat) as I needed to word wrap large cells (particularly when displaying JSON snippets). </p>
<h3>4. <a href="https://github.com/Athari/CsConsoleFormat">Alba.CsConsoleFormat</a></h3>
<p>As mentioned above <em>Alba.CsConsoleFormat</em> was a replacement package to render tables. With great options to not only style your table with colours but also specify word wrap options, it was a good choice for rendering large volumes of data.</p>
<p>I did find its syntax a little verbose to work with,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-variable">var</span> <span class="hljs-variable">headerThickness</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-variable">LineThickness</span><span class="hljs-punctuation">(</span><span class="hljs-variable">LineWidth</span><span class="hljs-operator">.</span><span class="hljs-variable">Double</span><span class="hljs-operator">,</span> <span class="hljs-variable">LineWidth</span><span class="hljs-operator">.</span><span class="hljs-variable">Single</span><span class="hljs-punctuation">)</span><span class="hljs-operator">;</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"><span class="hljs-variable">var</span> <span class="hljs-variable">doc</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-variable">Document</span><span class="hljs-punctuation">(</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    <span class="hljs-variable">new</span> <span class="hljs-built_in">Span</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Dinosaurs #&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">Color</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Yellow</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span> <span class="hljs-built_in">Order</span><span class="hljs-operator">.</span><span class="hljs-variable">Id</span><span class="hljs-operator">,</span> <span class="hljs-string">&quot;\n&quot;</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    <span class="hljs-variable">new</span> <span class="hljs-built_in">Span</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Type: &quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">Color</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Yellow</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span> <span class="hljs-built_in">Order</span><span class="hljs-operator">.</span><span class="hljs-variable">Customer</span><span class="hljs-operator">.</span><span class="hljs-variable">Name</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    <span class="hljs-variable">new</span> <span class="hljs-built_in">Grid</span> <span class="hljs-punctuation">{</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        <span class="hljs-variable">Color</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">Gray</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        <span class="hljs-variable">Columns</span> <span class="hljs-operator">=</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">GridLength</span><span class="hljs-operator">.</span><span class="hljs-variable">Auto</span><span class="hljs-operator">,</span> <span class="hljs-variable">GridLength</span><span class="hljs-operator">.</span><span class="hljs-built_in">Star</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span> <span class="hljs-variable">GridLength</span><span class="hljs-operator">.</span><span class="hljs-variable">Auto</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        <span class="hljs-variable">Children</span> <span class="hljs-operator">=</span> <span class="hljs-punctuation">{</span></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">            <span class="hljs-variable">new</span> <span class="hljs-built_in">Cell</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Id&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">Stroke</span> <span class="hljs-operator">=</span> <span class="hljs-variable">headerThickness</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">            <span class="hljs-variable">new</span> <span class="hljs-built_in">Cell</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Name&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">Stroke</span> <span class="hljs-operator">=</span> <span class="hljs-variable">headerThickness</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">            <span class="hljs-variable">new</span> <span class="hljs-built_in">Cell</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Count&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">Stroke</span> <span class="hljs-operator">=</span> <span class="hljs-variable">headerThickness</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">            <span class="hljs-built_in">Order</span><span class="hljs-operator">.</span><span class="hljs-variable">OrderItems</span><span class="hljs-operator">.</span><span class="hljs-built_in">Select</span><span class="hljs-punctuation">(</span><span class="hljs-variable">item</span> <span class="hljs-operator">=&gt;</span> <span class="hljs-variable">new</span><span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span> <span class="hljs-punctuation">{</span></span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">                <span class="hljs-variable">new</span> <span class="hljs-built_in">Cell</span><span class="hljs-punctuation">(</span><span class="hljs-variable">item</span><span class="hljs-operator">.</span><span class="hljs-variable">Id</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">                <span class="hljs-variable">new</span> <span class="hljs-built_in">Cell</span><span class="hljs-punctuation">(</span><span class="hljs-variable">item</span><span class="hljs-operator">.</span><span class="hljs-variable">Name</span><span class="hljs-punctuation">)</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">                <span class="hljs-variable">new</span> <span class="hljs-built_in">Cell</span><span class="hljs-punctuation">(</span><span class="hljs-variable">item</span><span class="hljs-operator">.</span><span class="hljs-built_in">Count</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span> <span class="hljs-variable">Align</span> <span class="hljs-operator">=</span> <span class="hljs-variable">Align</span><span class="hljs-operator">.</span><span class="hljs-built_in">Right</span> <span class="hljs-punctuation">}</span><span class="hljs-operator">,</span></span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">)</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">        <span class="hljs-punctuation">}</span></span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">    <span class="hljs-punctuation">}</span></span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content"><span class="hljs-punctuation">)</span><span class="hljs-operator">;</span></span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content"><span class="hljs-variable">ConsoleRenderer</span><span class="hljs-operator">.</span><span class="hljs-variable">RenderDocument</span><span class="hljs-punctuation">(</span><span class="hljs-variable">doc</span><span class="hljs-punctuation">)</span><span class="hljs-operator">;</span></span></span></code></pre><p>Buy my oh my does it produce a great console table üë®‚Äçüé®</p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/tfEbNlJ8U1oqZCdmXGfq0/7d9eae3125e0c3053c4dfe91335a104e/peekmessages.png" alt="CsConsoleFormat table output"></p>
<h3>5. <a href="https://github.com/mbdavid/LiteDB">LiteDb</a></h3>
<p>One of the requirements of Az-Lazy was to store a list of connections to be reused at any time. Since CLI&#39;s don&#39;t have any state, I needed a lightweight storage mechanism that can easily ship with the tool.</p>
<p>In comes <em>LiteDb</em>! With its entity framework style CRUD syntax, I really felt at home with this framework,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-comment">// Create your POCO class</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Dinosaur</span></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Id { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Name { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> Age { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"><span class="hljs-keyword">using</span>(<span class="hljs-keyword">var</span> db = <span class="hljs-keyword">new</span> LiteDatabase(<span class="hljs-string">@&quot;DinoDb.db&quot;</span>))</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">    <span class="hljs-keyword">var</span> collection = db.GetCollection&lt;Dinosaur&gt;(<span class="hljs-string">&quot;dinosaurs&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    <span class="hljs-keyword">var</span> dinosaur = <span class="hljs-keyword">new</span> Dinosaur</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">    { </span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">        Id = <span class="hljs-number">1</span></span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">        Name = <span class="hljs-string">&quot;T-Rex&quot;</span>, </span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">        Age = <span class="hljs-number">39</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">    };</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">    collection.Insert(dinosaur);</span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">    <span class="hljs-keyword">var</span> oldDinosaurs = col.Find(x =&gt; x.Age &gt; <span class="hljs-number">50</span>);</span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content">}</span></span></code></pre><p>Since <em>LiteDb</em> stores all its data into one file, from a tool perspective it ensures your not littering your client&#39;s computer with files.</p>
<h1>Packages used now</h1>
<h3>1. <a href="https://github.com/commandlineparser/commandline">CommandLineParser</a></h3>
<p>I&#39;ve still continued to use <em>CommandLineParser</em> however it&#39;s starting to hit some limitations, namely nesting of commands. So something like <code>azlazy connection add --name &quot;test&quot; --connection &quot;connectionString&quot;</code> is not allowed.</p>
<p>Whilst this package has been great to get me started, I might start looking at other options as Az-Lazy starts supporting more complex commands.</p>
<h3>2. <a href="https://github.com/mbdavid/LiteDB">LiteDb</a></h3>
<p>It just works, still happy with this package. Really recommend it for CLI tools!</p>
<h3>2. <a href="https://github.com/spectresystems/spectre.console">Spectre.Console</a></h3>
<p><em>Spectre.Console</em> was a big find for me, from the writer of <a href="https://github.com/cake-build/cake">Cake</a> (<a href="https://github.com/patriksvensson">Patrik Svensson</a>) it&#39;s a one-stop-shop for all your CLI needs. Just to name a few of the features,</p>
<ul>
<li>Console Colours</li>
<li>Progress bars</li>
<li>Tables</li>
<li>Prompts</li>
<li>Spinners</li>
</ul>
<p>After discovering this package I ended up doing a NuGet cull ü™ì which is why this list now stops at 3 (That culls still in progress as I&#39;m removing Pascal for Specters implementation).</p>
<p>I won&#39;t go into all the code samples for this, but here are a few, beginning with progress indicators (also note the syntax to colour the output).</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">await</span> AnsiConsole.Progress()</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">    .StartAsync(<span class="hljs-keyword">async</span> ctx =&gt;</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">        <span class="hljs-comment">// Define tasks</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">        <span class="hljs-keyword">var</span> dinoTask = ctx.AddTask(<span class="hljs-string">&quot;[green]Uploading dinosaurs[/]&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        <span class="hljs-keyword">while</span> (!ctx.IsFinished)</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">            <span class="hljs-comment">// Simulate some work</span></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">            <span class="hljs-keyword">await</span> Task.Delay(<span class="hljs-number">250</span>);</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">            dinoTask.Increment(<span class="hljs-number">1.5</span>);</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    });</span></span></code></pre><p>Check out how it looks in action, it&#39;s great for long-running tasks.</p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/7I5IMPuMYHvUIUyan3iNLY/d7b5e472fed4daba62218d4d2d3165ee/uploaddirectory.png" alt="Upload progress bar"></p>
<p>Table&#39;s are also strightforward to create,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">// <span class="hljs-keyword">Create</span> a <span class="hljs-keyword">table</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">var table = <span class="hljs-built_in">new</span> <span class="hljs-keyword">Table</span>();</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">// <span class="hljs-keyword">Add</span> <span class="hljs-keyword">some</span> <span class="hljs-keyword">columns</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content"><span class="hljs-keyword">table</span>.AddColumn(&quot;Foo&quot;);</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content"><span class="hljs-keyword">table</span>.AddColumn(<span class="hljs-built_in">new</span> TableColumn(&quot;Bar&quot;).Centered());</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">// <span class="hljs-keyword">Add</span> <span class="hljs-keyword">some</span> <span class="hljs-keyword">rows</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"><span class="hljs-keyword">table</span>.AddRow(&quot;Baz&quot;, &quot;[green]Qux[/]&quot;);</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content"><span class="hljs-keyword">table</span>.AddRow(<span class="hljs-built_in">new</span> Markup(&quot;[blue]Corgi[/]&quot;), <span class="hljs-built_in">new</span> Panel(&quot;Waldo&quot;));</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">// Render the <span class="hljs-keyword">table</span> <span class="hljs-keyword">to</span> the console</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">AnsiConsole.Render(<span class="hljs-keyword">table</span>);</span></span></code></pre><h1>Other great code snippets</h1>
<p>The only thing lacking for me in <em>Specter.Console</em> was display a tree structure which is useful for folder hierarchies, (there is an open issue here if you want to <a href="https://github.com/spectresystems/spectre.console/issues/144">show your interest</a>) üôè.</p>
<p>To fulfil this requirement, I found a great article by Andrew Lock which renders this structure, <a href="https://andrewlock.net/creating-an-ascii-art-tree-in-csharp/">Creating an ASCII-art tree in C#</a>. Here&#39;s what it looks like for me,</p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/6DeIXSOgHE0DO7STrDJPrw/281dd0130f40d8764dc9cdb6e3933509/containertree.png" alt="Printing Tree structure"></p>
<h1>Why I chose .NET</h1>
<p>So initially I was torn between Node JS and C#, there was an especially compelling article by <a href="https://www.twilio.com/blog/how-to-build-a-cli-with-node-js">Twilio</a> outlining how you can create a great CLI experience that was winning me over. They also went so far as suggesting some interesting packages to make use of, here&#39;s a snippet of whats comparable with what I used for az-lazy.</p>
<ul>
<li><a href="http://npm.im/inquirer">inquirer</a>, <a href="http://npm.im/enquirer">enquirer</a> or <a href="https://npm.im/prompts">prompts</a> for complex input prompts</li>
<li><a href="http://npm.im/chalk">chalk</a> or <a href="https://npm.im/kleur">kleur</a> for colored output</li>
<li><a href="http://npm.im/ora">ora</a> for beautiful spinners</li>
<li><a href="http://npm.im/boxen">boxen</a> for drawing boxes around your output</li>
<li><a href="http://npm.im/stmux">stmux</a> for a tmux like UI</li>
<li><a href="http://npm.im/listr">listr</a> for progress lists</li>
<li><a href="http://npm.im/meow">meow</a> or <a href="http://npm.im/arg">arg</a> for basic argument parsing</li>
<li><a href="http://npm.im/commander">commander</a> and <a href="https://www.npmjs.com/package/yargs">yargs</a> for complex argument parsing and subcommand support</li>
<li><a href="https://oclif.io/">oclif</a> a framework for building extensible CLIs by Heroku (<a href="https://infinitered.github.io/gluegun/#/">gluegun</a> as an alternative)</li>
</ul>
<p>Whilst the NuGet ecosystem is not as diverse as npm, after discovering <em>Spectre.Console</em>, I found that its a one-stop-shop for most of those npm packages mentioned above.</p>
<p>The deciding factor for me however was down to the userbase I was targeting. I figured the majority of my userbase would be more familiar with dotnet than npm, and this solidified the decision. However, whatever platform you choose I believe theres enough packages available to make a great CLI experience.</p>
<h1>How to create a .NET CLI tool</h1>
<p>This guide shows you how to create a bare-bones .NET CLI tool.</p>
<h3>1. Creating a new project</h3>
<p>Let&#39;s start by creating a new directory and console application.</p>
<ol>
<li><code>mkdir barebonescli</code></li>
<li><code>cd barebonescli</code></li>
<li><code>dotnet new console</code></li>
<li>The console app will already come with a standard-issue <code>Console.Writeline(&quot;Hello World&quot;);</code> üòÅ</li>
</ol>
<h3>2. Package as a tool</h3>
<p>What distinguishes your console app from a dotnet tool is purly the .csproj file. In particular the package as a tool option <code>&lt;PackAsTool&gt;true&lt;/PackAsTool&gt;</code>, Id which needs to be unique across all the NuGet packages in the gallery <code>&lt;Id&gt;azlazy&lt;/Id&gt;</code> and tool command name <code>&lt;ToolCommandName&gt;azlazy&lt;/ToolCommandName&gt;</code>. The full .csproj should look like this,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-tag">&lt;<span class="hljs-name">Project</span> <span class="hljs-attr">Sdk</span>=<span class="hljs-string">&quot;Microsoft.NET.Sdk&quot;</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">  <span class="hljs-tag">&lt;<span class="hljs-name">PropertyGroup</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">OutputType</span>&gt;</span>Exe<span class="hljs-tag">&lt;/<span class="hljs-name">OutputType</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">TargetFramework</span>&gt;</span>netcoreapp3.1<span class="hljs-tag">&lt;/<span class="hljs-name">TargetFramework</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">RootNamespace</span>&gt;</span>barebonescli<span class="hljs-tag">&lt;/<span class="hljs-name">RootNamespace</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackAsTool</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">PackAsTool</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">ToolCommandName</span>&gt;</span>barebones<span class="hljs-tag">&lt;/<span class="hljs-name">ToolCommandName</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageOutputPath</span>&gt;</span>./nupkg<span class="hljs-tag">&lt;/<span class="hljs-name">PackageOutputPath</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">Version</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Id</span>&gt;</span>barebonescli<span class="hljs-tag">&lt;/<span class="hljs-name">Id</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Authors</span>&gt;</span>Faesel Saeed<span class="hljs-tag">&lt;/<span class="hljs-name">Authors</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Owners</span>&gt;</span>Faesel Saeed<span class="hljs-tag">&lt;/<span class="hljs-name">Owners</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Title</span>&gt;</span>Demo app to show a bare bones CLI<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Description</span>&gt;</span>This great CLI can greet the world<span class="hljs-tag">&lt;/<span class="hljs-name">Description</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">Copyright</span>&gt;</span>Copyright 2020 Faesel Saeed<span class="hljs-tag">&lt;/<span class="hljs-name">Copyright</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageRequireLicenseAcceptance</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">PackageRequireLicenseAcceptance</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageLicenseFile</span>&gt;</span>LICENSE.txt<span class="hljs-tag">&lt;/<span class="hljs-name">PackageLicenseFile</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageIconUrl</span>&gt;</span>https://raw.githubusercontent.com/faesel/barebonescli/main/barebones/icon.png<span class="hljs-tag">&lt;/<span class="hljs-name">PackageIconUrl</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageTags</span>&gt;</span>barebones greeting cli<span class="hljs-tag">&lt;/<span class="hljs-name">PackageTags</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">RepositoryUrl</span>&gt;</span>https://github.com/faesel/barebonescli.git<span class="hljs-tag">&lt;/<span class="hljs-name">RepositoryUrl</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">RepositoryType</span>&gt;</span>git<span class="hljs-tag">&lt;/<span class="hljs-name">RepositoryType</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">RepositoryBranch</span>&gt;</span>main<span class="hljs-tag">&lt;/<span class="hljs-name">RepositoryBranch</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageProjectUrl</span>&gt;</span>https://github.com/faesel/barebonescli<span class="hljs-tag">&lt;/<span class="hljs-name">PackageProjectUrl</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">24</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageIcon</span>&gt;</span>icon.png<span class="hljs-tag">&lt;/<span class="hljs-name">PackageIcon</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">25</span><span class="line-content">  <span class="hljs-tag">&lt;/<span class="hljs-name">PropertyGroup</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">26</span><span class="line-content">  <span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">27</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">PackageReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;Microsoft.Extensions.DependencyInjection&quot;</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">&quot;3.1.9&quot;</span> /&gt;</span></span></span>
<span class="code-line"><span class="line-number">28</span><span class="line-content">    ...</span></span>
<span class="code-line"><span class="line-number">29</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">None</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;LICENSE.txt&quot;</span> <span class="hljs-attr">Pack</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">PackagePath</span>=<span class="hljs-string">&quot;$(PackageLicenseFile)&quot;</span> /&gt;</span></span></span>
<span class="code-line"><span class="line-number">30</span><span class="line-content">    <span class="hljs-tag">&lt;<span class="hljs-name">None</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">&quot;icon.png&quot;</span> <span class="hljs-attr">Pack</span>=<span class="hljs-string">&quot;true&quot;</span> <span class="hljs-attr">PackagePath</span>=<span class="hljs-string">&quot;\&quot;</span> /&gt;</span></span></span>
<span class="code-line"><span class="line-number">31</span><span class="line-content">  <span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span></span></span>
<span class="code-line"><span class="line-number">32</span><span class="line-content"><span class="hljs-tag">&lt;/<span class="hljs-name">Project</span>&gt;</span></span></span></code></pre><p><em>The Github links are fictional, you can replace them with your project.</em></p>
<p>To make your package more credible in the NuGet gallery there are other fields you can fill in. For the licence and package icon, you will need to place the files in the same project, the folder structure will look something like this, </p>
<p>barebonescli</p>
<ul>
<li>barebonescli.csproj</li>
<li>Program.cs</li>
<li>icon.png</li>
<li>LICENCE.txt</li>
</ul>
<h3>3. Package your CLI</h3>
<p>The next step is to create a NuGet package, if you specified a <code>PackageOutputPath</code> in your .csproj you will see the NuGet package in that folder. </p>
<ol>
<li>Run <code>dotnet pack</code> on the project</li>
</ol>
<p>Once executed you should have a <code>barebonescli.1.0.0.nupkg</code> file.</p>
<h3>4. Upload your package to the <a href="https://www.nuget.org/">Nuget gallery</a></h3>
<ol>
<li>Click on your profile</li>
<li>Select upload package and upload the nupkg file</li>
</ol>
<p><img src="//images.ctfassets.net/wjg1udsw901v/4nzpdnGHTMflgXhTNRw57Y/a37a98cfc3a5bcf56e6ba1cbb7bbb5ac/uploadingpackages.png" alt="Nuget package upload"></p>
<p>You could also alternatively use the CLI to push with <code>nuget push barebonescli.1.0.0.nupkg</code></p>
<p>Once uploaded it will be ready to install as soon as its indexed,  <code>dotnet tool install --global barebonescli --version 1.0.0</code> üòé</p>
<p>From here the packages mentioned in this article can help you create a professional-looking CLI.</p>
<h1>More about Az-Lazy</h1>
<p>If you&#39;re interested in checking out Az-Lazy, you can install in with the command,</p>
<p><code>dotnet tool install --global az-lazy</code></p>
<h1>Usefull links</h1>
<p>Do checkout <em>Nuget Must Haves</em> command-line tagged package list, there&#39;s some great options in there that are not mentioned in this article.</p>
<p><a href="https://nugetmusthaves.com/Tag/Commandline?page=1">Nuet Must Haves - CommandLine Packages</a></p>
0:{"buildId":"GRQ4Wn3Dp8FngowyVAxrt","rsc":["$","$1","c",{"children":[[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"$2"}}],["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BreadcrumbList\",\"itemListElement\":[{\"@type\":\"ListItem\",\"position\":1,\"name\":\"Home\",\"item\":\"https://www.faesel.com\"},{\"@type\":\"ListItem\",\"position\":2,\"name\":\"Blog\",\"item\":\"https://www.faesel.com/blog\"},{\"@type\":\"ListItem\",\"position\":3,\"name\":\"My journey of creating a .NET CLI tool\",\"item\":\"https://www.faesel.com/blog/my-journey-of-creating-a-dotnet-cli-tool\"}]}"}}],["$","article",null,{"className":"page-module__dgei_G__article","children":[["$","$L3",null,{"href":"/blog","className":"page-module__dgei_G__backLink","children":"‚Üê Back to Blog"}],["$","header",null,{"className":"page-module__dgei_G__header","children":[["$","h1",null,{"className":"page-module__dgei_G__title","children":"My journey of creating a .NET CLI tool"}],["$","div",null,{"className":"page-module__dgei_G__meta","children":["$","time",null,{"className":"page-module__dgei_G__date","dateTime":"2020-12-18T00:00+00:00","children":["üìÖ ","December 18, 2020"]}]}],["$","div",null,{"className":"page-module__dgei_G__tags","children":[["$","span","cli-0",{"className":"page-module__dgei_G__tag","children":"cli"}],["$","span","azure-1",{"className":"page-module__dgei_G__tag","children":"azure"}],["$","span","queues-2",{"className":"page-module__dgei_G__tag","children":"queues"}],["$","span","table-storage-3",{"className":"page-module__dgei_G__tag","children":"table-storage"}],["$","span","containers-4",{"className":"page-module__dgei_G__tag","children":"containers"}],["$","span","blob-5",{"className":"page-module__dgei_G__tag","children":"blob"}],["$","span","azure-storage-6",{"className":"page-module__dgei_G__tag","children":"azure-storage"}],["$","span","dotnet-tools-7",{"className":"page-module__dgei_G__tag","children":"dotnet-tools"}],["$","span","az-lazy-8",{"className":"page-module__dgei_G__tag","children":"az-lazy"}],["$","span","console-9",{"className":"page-module__dgei_G__tag","children":"console"}],["$","span","commandline-10",{"className":"page-module__dgei_G__tag","children":"commandline"}]]}]]}],["$","div",null,{"className":"page-module__dgei_G__heroImage","children":["$","$L4",null,{"src":"https://images.ctfassets.net/wjg1udsw901v/5nkhsfNMJDJ5NGcAfvQ2Lt/a2ac18006da7a4865044b77365b55987/AzLazy.png","alt":"My journey of creating a .NET CLI tool","fill":true,"className":"page-module__dgei_G__heroImageImg","priority":true,"sizes":"(max-width: 800px) 100vw, 800px"}]}],["$","div",null,{"className":"page-module__dgei_G__content","dangerouslySetInnerHTML":{"__html":"$5"}}]]}]],["$L6"],"$L7"]}],"loading":null,"isPartial":false}
6:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/bc2ec6988ea822be.css","precedence":"next"}]
7:["$","$L8",null,{"children":["$","$9",null,{"name":"Next.MetadataOutlet","children":"$@a"}]}]
a:null
