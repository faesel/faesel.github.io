<!DOCTYPE html><!--Oqm01v_5exOWumYC57wkW--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/images/logo-small.png"/><link rel="preload" as="image" href="https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg"/><link rel="stylesheet" href="/_next/static/chunks/19d110f125a6a880.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/4c98436a675d5713.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/ba947f6798c3c403.js"/><script src="/_next/static/chunks/9a513a8c4dabec14.js" async=""></script><script src="/_next/static/chunks/713fc8ad9ceac69a.js" async=""></script><script src="/_next/static/chunks/19e94e7551cef099.js" async=""></script><script src="/_next/static/chunks/turbopack-2ca5897f65736e1e.js" async=""></script><script src="/_next/static/chunks/8be72f203fe36d6f.js" async=""></script><script src="/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/_next/static/chunks/708205fa81a1891d.js" async=""></script><script src="/_next/static/chunks/34e59d4fa8652639.js" async=""></script><link rel="preload" href="/_next/static/chunks/578ca6ed020117e9.css" as="style"/><link rel="preload" href="https://www.googletagmanager.com/gtag/js?id=G-Y039CLFJME" as="script"/><title>ASP.NET GraphQL server with Hot Chocolate | Tech Blog | FAESEL.COM</title><meta name="description" content="# Starting my journey with GraphQL

Up till now, I&#x27;ve always heavily relied on RESTfull services to power API&#x27;s, this recently got widened with GRPC which you c"/><link rel="author" href="https://www.faesel.com/about"/><meta name="author" content="Faesel Saeed"/><meta name="keywords" content="graphql,hotchocolate,graphql-voyager,asp.net,authentication,authorization,versioning,rest,chilli-cream,logging,open-telemetry,banana-cake-pop"/><meta property="og:title" content="ASP.NET GraphQL server with Hot Chocolate"/><meta property="og:description" content="# Starting my journey with GraphQL

Up till now, I&#x27;ve always heavily relied on RESTfull services to power API&#x27;s, this recently got widened with GRPC which you c"/><meta property="og:image" content="https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2021-04-05T00:00+01:00"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@faeselsaeed"/><meta name="twitter:creator" content="@faeselsaeed"/><meta name="twitter:title" content="ASP.NET GraphQL server with Hot Chocolate"/><meta name="twitter:description" content="# Starting my journey with GraphQL

Up till now, I&#x27;ve always heavily relied on RESTfull services to power API&#x27;s, this recently got widened with GRPC which you c"/><meta name="twitter:image" content="https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" href="/favicon.ico"/><link rel="apple-touch-icon" href="/favicon.ico"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com","logo":{"@type":"ImageObject","url":"https://www.faesel.com/images/logo.png"},"sameAs":["https://github.com/faesel","https://www.linkedin.com/in/faesel-saeed-a97b1614"]}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"WebSite","name":"FAESEL.COM","url":"https://www.faesel.com","description":"A modern tech blog exploring technology, coding, and digital innovation","publisher":{"@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com"}}</script><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><a href="#main-content" class="skip-to-content">Skip to content</a><header class="Header-module__hBw1pG__header"><div class="Header-module__hBw1pG__container"><a class="Header-module__hBw1pG__logo" aria-label="Home" href="/"><img alt="Logo" width="40" height="40" decoding="async" data-nimg="1" class="Header-module__hBw1pG__logoImage" style="color:transparent" src="/images/logo-small.png"/></a><button class="Header-module__hBw1pG__mobileMenuButton" aria-label="Toggle menu" aria-expanded="false">‚ò∞</button><nav class="Header-module__hBw1pG__nav " role="navigation" aria-label="Main navigation"><a class="Header-module__hBw1pG__navLink " href="/">Home</a><a class="Header-module__hBw1pG__navLink " href="/blog">Blog</a><a class="Header-module__hBw1pG__navLink " href="/projects">Projects</a><a class="Header-module__hBw1pG__navLink " href="/about">About</a><a class="Header-module__hBw1pG__navLink " href="/contact">Contact</a></nav></div></header><main id="main-content" style="min-height:70vh"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"ASP.NET GraphQL server with Hot Chocolate","description":"# Starting my journey with GraphQL\n\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c","image":"https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg","datePublished":"2021-04-05T00:00+01:00","dateModified":"2021-04-05T00:00+01:00","author":{"@type":"Person","name":"Faesel Saeed","url":"https://www.faesel.com/about"},"publisher":{"@type":"Organization","name":"Faesel Saeed","url":"https://www.faesel.com","logo":{"@type":"ImageObject","url":"https://www.faesel.com/images/logo.png"}},"keywords":"graphql, hotchocolate, graphql-voyager, asp.net, authentication, authorization, versioning, rest, chilli-cream, logging, open-telemetry, banana-cake-pop","url":"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate"}}</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.faesel.com"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://www.faesel.com/blog"},{"@type":"ListItem","position":3,"name":"ASP.NET GraphQL server with Hot Chocolate","item":"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate"}]}</script><article class="page-module__dgei_G__article"><a class="page-module__dgei_G__backLink" href="/blog">‚Üê Back to Blog</a><header class="page-module__dgei_G__header"><h1 class="page-module__dgei_G__title">ASP.NET GraphQL server with Hot Chocolate</h1><div class="page-module__dgei_G__meta"><time class="page-module__dgei_G__date" dateTime="2021-04-05T00:00+01:00">üìÖ <!-- -->April 4, 2021</time><span class="page-module__dgei_G__separator">‚Ä¢</span><span class="page-module__dgei_G__readingTime">‚è±Ô∏è <!-- -->10 min read</span></div><div class="page-module__dgei_G__tags"><span class="page-module__dgei_G__tag">graphql</span><span class="page-module__dgei_G__tag">hotchocolate</span><span class="page-module__dgei_G__tag">graphql-voyager</span><span class="page-module__dgei_G__tag">asp.net</span><span class="page-module__dgei_G__tag">authentication</span><span class="page-module__dgei_G__tag">authorization</span><span class="page-module__dgei_G__tag">versioning</span><span class="page-module__dgei_G__tag">rest</span><span class="page-module__dgei_G__tag">chilli-cream</span><span class="page-module__dgei_G__tag">logging</span><span class="page-module__dgei_G__tag">open-telemetry</span><span class="page-module__dgei_G__tag">banana-cake-pop</span></div></header><div class="page-module__dgei_G__heroImage"><img alt="ASP.NET GraphQL server with Hot Chocolate" decoding="async" data-nimg="fill" class="page-module__dgei_G__heroImageImg" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" src="https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg"/></div><div class="ShareButtons-module__iQZDeW__floating"><div class="ShareButtons-module__iQZDeW__buttons"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate&amp;text=ASP.NET%20GraphQL%20server%20with%20Hot%20Chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__twitter" aria-label="Share on Twitter"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__linkedin" aria-label="Share on LinkedIn"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__facebook" aria-label="Share on Facebook"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a href="https://reddit.com/submit?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate&amp;title=ASP.NET%20GraphQL%20server%20with%20Hot%20Chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__reddit" aria-label="Share on Reddit"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"></path></svg></a><a href="mailto:?subject=ASP.NET%20GraphQL%20server%20with%20Hot%20Chocolate&amp;body=%23%20Starting%20my%20journey%20with%20GraphQL%0A%0AUp%20till%20now%2C%20I&#x27;ve%20always%20heavily%20relied%20on%20RESTfull%20services%20to%20power%20API&#x27;s%2C%20this%20recently%20got%20widened%20with%20GRPC%20which%20you%20c%0A%0Ahttps%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__email" aria-label="Share via Email"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a><button class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__copy " aria-label="Copy link"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div></div><div class="page-module__dgei_G__content"><h1>Starting my journey with GraphQL</h1>
<p>Up till now, I&#39;ve always heavily relied on RESTfull services to power API&#39;s, this recently got widened with GRPC which you can read about in my article <a href="https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you">.NET &amp; GRPC What they forgot to tell you</a>. GraphQL was the third final frontier that needed exploring ü•æ...until now.</p>
<p>Having looked at it a year back the implementations for .NET were in their infancy, which meant that your server would only be as good as the framework you choose. Fast forward to 2021, <a href="https://github.com/ChilliCream/hotchocolate">Chilli Creams Hotchocolate</a> has gained some serious ground and makes GraphQL an appealing proposition for developers.</p>
<p>In this article I hope to cover two main points,</p>
<ul>
<li>How REST is designed to break backend engineers</li>
<li>How GraphQL saves the day</li>
</ul>
<h1>Your typical REST scenario</h1>
<p>Let&#39;s paint the scene, your a backend engineer who&#39;s creating an endpoint for showing a list of cats. With your battle-tested REST knowledge, you set out to create your first basic endpoint in the <code>CatsController</code> that returns all cats and the front end engineer is ready to integrate it into his UI.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-comment">// api/cats</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">[<span class="hljs-meta">HttpGet</span>]</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;IActionResult&gt; <span class="hljs-title">GetCats</span>()</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = contextFactory.CreateDbContext())</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        <span class="hljs-keyword">var</span> cats = <span class="hljs-keyword">await</span> context.Cats.ToListAsync();</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        <span class="hljs-keyword">if</span>(cat != <span class="hljs-literal">null</span>)</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">            <span class="hljs-keyword">return</span> Ok(cats);</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    <span class="hljs-keyword">return</span> NoContent();</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">}</span></span></code></pre><p>The app soon becomes a hit! your product manager decides to expand the functionality to filter by cat descriptions and to create a new cat information page. Getting to work you expand the endpoints for the front end engineers to use.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-comment">//api/cats/1</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">[<span class="hljs-meta">HttpGet</span>]</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">[<span class="hljs-meta">Route(<span class="hljs-string">&quot;{id}&quot;</span>)</span>]</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;IActionResult&gt; <span class="hljs-title">GetCatsById</span>(<span class="hljs-params">[FromRoute] <span class="hljs-built_in">int</span> id</span>)</span></span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = contextFactory.CreateDbContext())</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        <span class="hljs-keyword">var</span> cats = <span class="hljs-keyword">await</span> context.Cats.FirstOrDefaultAsync(x =&gt; x.Id == id);</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">        <span class="hljs-keyword">if</span>(cats != <span class="hljs-literal">null</span>)</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">            <span class="hljs-keyword">return</span> Ok(cats);</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">    <span class="hljs-keyword">return</span> NoContent();</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content"><span class="hljs-comment">// api/cats/description/brown</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">[<span class="hljs-meta">HttpGet</span>]</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">[<span class="hljs-meta">Route(<span class="hljs-string">&quot;description/{description}&quot;</span>)</span>]</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task&lt;IActionResult&gt; <span class="hljs-title">GetCatsByDescription</span>(<span class="hljs-params">[FromRoute] <span class="hljs-built_in">string</span> description</span>)</span></span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">    <span class="hljs-keyword">using</span> (<span class="hljs-keyword">var</span> context = contextFactory.CreateDbContext())</span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">24</span><span class="line-content">        <span class="hljs-keyword">var</span> cats = <span class="hljs-keyword">await</span> context.Cats.Where(x =&gt; x.Description.Contains(description)).ToListAsync();</span></span>
<span class="code-line"><span class="line-number">25</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">26</span><span class="line-content">        <span class="hljs-keyword">if</span>(cats != <span class="hljs-literal">null</span>)</span></span>
<span class="code-line"><span class="line-number">27</span><span class="line-content">            <span class="hljs-keyword">return</span> Ok(payload);</span></span>
<span class="code-line"><span class="line-number">28</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">29</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">30</span><span class="line-content">    <span class="hljs-keyword">return</span> NoContent();</span></span>
<span class="code-line"><span class="line-number">31</span><span class="line-content">}</span></span></code></pre><p>The cycle continues with product owners coming up with more feature requests and at the bottom of the pile, you got the backend engineer being reactive to all the changes. By the time you&#39;ve wrapped up the project your left with a code smell of 10+ endpoints üí©.</p>
<p>The situation further degrades after a year when the UI gets redesigned and features are culled based on user usage. You end up with random floating endpoints because quite frankly no one audits their endpoints for dead code.</p>
<p>This is where GraphQL steps in, it switches the responsibility of an engineer from anticipating and creating endpoints to simply upfront displaying everything that&#39;s available with declarative meaning.</p>
<h1>Hot Chocolate (.NET GraphQL server framework)</h1>
<p>Hot chocolate is one of the leading implementations of a GraphQL server, one important thing to note when choosing a framework is that your implementation will only be as good as the framework you choose. As the <a href="http://spec.graphql.org/">GraphQL specification</a> progresses you want a framework that keeps up to date with the changes... Hot Chocolate does that.</p>
<p>To understand the basics of Hot Chocolate I recommend <a href="https://www.youtube.com/user/binarythistle"><strong>Les Jackson&#39;s</strong></a> free course on youtube. It is a bit lengthy at 3 Hours and 45 Minutes but it allows you to create an ASP.NET implementation from scratch and understand basic concepts like Querys, Mutations and Subscriptions. By the end of the course, you have a GraphQL service that can do CRUD actions (do üëç his video it&#39;s great!).</p>
<p><a href="https://www.youtube.com/watch?v=HuN94qNwQmM">https://www.youtube.com/watch?v=HuN94qNwQmM</a></p>
<p>The source code he produces can also be found on his <a href="https://github.com/binarythistle/S04E01---.NET-5-GraphQL-API">github repo</a>. The source code is a great starting point as it creates a docker image containing an MSSQL database. The solution itself already has Entity Framework and Hot Chocolate bootstrapped, with two entities to test with.</p>
<p>On top of this <a href="https://github.com/ChilliCream/hotchocolate/blob/main/src/BananaCakePop">Banana Cake Pop üçå</a> is also integrated which allows you to query your server through a browser (similar to swagger).</p>
<p>As well as <a href="https://github.com/APIs-guru/graphql-voyager">GraphQL Voyager üöÄ</a> (do checkout the <a href="https://apis.guru/graphql-voyager/">live demo</a>).</p>
<p>To understand the remainder of the article it&#39;s important to have some basic knowledge of Hot Chocolate.</p>
<h1>GraphQl Voyager</h1>
<p>Whilst this is an addition to what&#39;s being discussed, it&#39;s worth briefly mentioning. Voyager helps facilitate the move of a backend engineer from creating and documenting prescriptive REST endpoints to simply becoming a harbour of documentation and entities.</p>
<blockquote>
<p>The marker of a quality API has shifted from creating a subjectively RESTfull API and how well it&#39;s documented to ... just how well it&#39;s documented üìù.</p>
</blockquote>
<p>Here&#39;s a taste of what is looks like for our API,</p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/8f7Kb65mDXS5ZBSA4At50/08bcdb6bfe661bdb50965e7b9e8d5a81/graphql-voyager.png" alt="Graphql Voyager"></p>
<h1>What they forgot to mention</h1>
<p>Up till now what we have discussed fits the 80% CRUD usecase, however as we know API&#39;s that are in the wild also deal with a range of other responsibilities. The remainder of this article is to shed some light on how this is done.</p>
<h2>How to version your API</h2>
<p>The typical versioning strategy for REST is to version using URLs <code>https://api.cats.com/v1</code> (when developers can be bothered). However with GraphQL as your only ever posting to a single endpoint that strategy is no longer a prefered solution.</p>
<blockquote>
<p>While there&#39;s nothing that prevents a GraphQL service from being versioned just like any other REST API, GraphQL takes a strong opinion on avoiding versioning by providing the tools for the continuous evolution of a GraphQL schema.<br><em><a href="https://graphql.org/learn/best-practices/">Taken from GraphQL Best Practices</a></em></p>
</blockquote>
<p>Before we begin on how to version, there are some distinct points to note.</p>
<p>Non-breaking changes can continue as they would with REST, adding properties to entities (as you would with response models in REST), continues to be a way to evolve your API. Similarly adding new query types to your GraphQL server is also deemed as a non-breaking change, and is equivalent to adding new endpoints in REST.</p>
<p>GraphQL aids in breaking changes caused due to nullability as <strong>everything</strong> unless specified is treated as nullable. This leads to upfront resilience on the front end to missing data, the <code>id: Int!</code> in the example below cannot be null.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">type</span> <span class="hljs-type">Cats</span> {</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">  id: <span class="hljs-type">Int</span>!</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">  name: <span class="hljs-type">String</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">}</span></span></code></pre><p>Eventually, we do still hit circumstances where a breaking change is needed. In these situations we have two strategies. The first as <a href="https://chillicream.com/docs/hotchocolate/defining-a-schema/versioning/">Chilli Cream Docs</a> specify is to add deprecated flags to old properties and begin to shift usage to new versions.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">public class CatsType : ObjectType&lt;Cats&gt;</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    <span class="hljs-keyword">protected</span> override <span class="hljs-type">void</span> Configure(IObjectTypeDescriptor&lt;Cats&gt; descriptor)</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">        descriptor.Description(<span class="hljs-string">&quot;Represents commands available on a platform&quot;</span>)<span class="hljs-comment">;</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content"></span></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        descriptor.Field(<span class="hljs-keyword">x</span> <span class="hljs-operator">=</span>&gt; <span class="hljs-keyword">x</span>.Name).Deprecated(<span class="hljs-string">&quot;This is no longer used, use FirstName and LastName&quot;</span>)<span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        descriptor.Field(<span class="hljs-keyword">x</span> <span class="hljs-operator">=</span>&gt; <span class="hljs-keyword">x</span>.FirstName)<span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">        descriptor.Field(<span class="hljs-keyword">x</span> <span class="hljs-operator">=</span>&gt; <span class="hljs-keyword">x</span>.LastName)<span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">}</span></span></code></pre><p>For client developers, this then creates warnings when using a deprecated property.</p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/2BkWWBcz1UAAU9fFVavBGQ/c812ee032ddcd8eb600b165616f68e5b/Screenshot_2021-03-26_153337.png" alt="Depricated GraphQL property"></p>
<p>Whilst this approach works over time it could create a lot of noise if you have many deprecated properties, an alternative approach is to split the entity entirely, use different classes between the two versions. Here is an example, we start by creating two query types,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">CatResponse1</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> Id, <span class="hljs-built_in">string</span> Name</span>)</span>;</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title">CatResponse2</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> Id, <span class="hljs-built_in">string</span> FirstName, <span class="hljs-built_in">string</span> LastName</span>)</span>;</span></span></code></pre><p>Both of these would contain their own Code First type files</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CatType1</span> : <span class="hljs-title">ObjectType</span>&lt;<span class="hljs-title">CatResponse1</span>&gt;</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IObjectTypeDescriptor&lt;CatResponse1&gt; descriptor</span>)</span></span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">        descriptor.Description(<span class="hljs-string">&quot;Represents cats!&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        descriptor.Field(x =&gt; x.Name)</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">            .Description(<span class="hljs-string">&quot;Represents the name of the cat&quot;</span>)</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">            .Deprecated(<span class="hljs-string">&quot;This is no longer used, use FirstName and LastName from Cat2&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CatType2</span> : <span class="hljs-title">ObjectType</span>&lt;<span class="hljs-title">CatResponse2</span>&gt;</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IObjectTypeDescriptor&lt;CatResponse2&gt; descriptor</span>)</span></span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">        descriptor.Description(<span class="hljs-string">&quot;Represents cats!&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">        descriptor.Field(x =&gt; x.FirstName)</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">            .Description(<span class="hljs-string">&quot;Represents the name firstname of the cat&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">        descriptor.Field(x =&gt; x.LastName)</span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">            .Description(<span class="hljs-string">&quot;Represents the name lastname of the cat&quot;</span>);</span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">24</span><span class="line-content">}</span></span></code></pre><p>The final piece of code is to use the intermediary response models. Under the hood we are still using the same EF entity.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Query</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    [<span class="hljs-meta">UseDbContext(typeof(AppDbContext))</span>]</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    [<span class="hljs-meta">UseFiltering</span>]</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    [<span class="hljs-meta">UseSorting</span>]</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">public</span> IQueryable&lt;CatResponse1&gt; <span class="hljs-title">GetCat1</span>(<span class="hljs-params">[ScopedService] AppDbContext context</span>)</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        <span class="hljs-keyword">var</span> cats = context.Cats;</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">        <span class="hljs-keyword">return</span> cats.Select(x =&gt; <span class="hljs-keyword">new</span> CatResponse1(x.Id, x.Name));</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    [<span class="hljs-meta">UseDbContext(typeof(AppDbContext))</span>]</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">    [<span class="hljs-meta">UseFiltering</span>]</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">    [<span class="hljs-meta">UseSorting</span>]</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">public</span> IQueryable&lt;CatResponse2&gt; <span class="hljs-title">GetCat2</span>(<span class="hljs-params">[ScopedService] AppDbContext context</span>)</span></span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">        <span class="hljs-keyword">var</span> cats = context.Cats;</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">        <span class="hljs-keyword">return</span> cats.Select(x =&gt; <span class="hljs-keyword">new</span> CatResponse2(x.Id, x.FirstName, x.LastName));</span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content"></span></span></code></pre><p>These changes now allow us to split our models, the two can be queried independently.</p>
<p><img src="//images.ctfassets.net/wjg1udsw901v/4RSPAHISSIpKS3qFfZbRq1/b53386073d0e86bc0e14a95b30ff857a/versioned-entities.png" alt="Versioned types"></p>
<h2>How to do Authentication</h2>
<p>Since Hot Chocolate works on top of ASP.NET we can leverage on all the traditional Authentication pipelines we use for REST, nothing changes! To demonstrate this I&#39;m going to extend the base implementation with a basic authentication mechanism using a header value <code>x-api-key</code> and a key defined in the <code>appsettings.json</code>.</p>
<h3>Adding key-based authentication</h3>
<p>To begin let&#39;s first add basic app settings to hold our authentication key (this represents the key the client will pass to the server to authentication their request), and create a class to deserialise into using <code>IOptions</code> interface.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">//Code goes <span class="hljs-keyword">into</span> appsettings.json</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">&quot;AuthenticationSettings&quot;: {</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    &quot;AuthenticationToken&quot;: &quot;secret123&quot;</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">//<span class="hljs-built_in">New</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">to</span> serialize <span class="hljs-keyword">into</span></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content"><span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> AuthenticationSettings</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">    <span class="hljs-built_in">public</span> string AuthenticationToken { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">//Register the <span class="hljs-keyword">configuration</span> <span class="hljs-keyword">in</span> Startup.cs &gt; ConfigureServices <span class="hljs-keyword">function</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">services.Configure&lt;AuthenticationSettings&gt;(<span class="hljs-keyword">Configuration</span>.GetSection(nameof(AuthenticationSettings)));</span></span></code></pre><p>Next we will create authentication scheme options as follows,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">ApiKeyAuthenticationOptions</span> : <span class="hljs-symbol">AuthenticationSchemeOptions</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> DefaultScheme = <span class="hljs-string">&quot;KeyBasedScheme&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Scheme =&gt; DefaultScheme;</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> AuthenticationType = DefaultScheme;</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">}</span></span></code></pre><p>The next part is where the crux of the code is, the <code>AuthenticationHandler</code> is what determines whether the request was correctly authenticated. On a successful attempt, it populates the ClaimsPrinciple.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ApiKeyAuthenticationHandler</span> : <span class="hljs-title">AuthenticationHandler</span>&lt;<span class="hljs-title">ApiKeyAuthenticationOptions</span>&gt;</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> ProblemDetailsContentType = <span class="hljs-string">&quot;application/problem+json&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">const</span> <span class="hljs-built_in">string</span> AuthenticationHeaderName = <span class="hljs-string">&quot;x-api-key&quot;</span>;</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> AuthenticationSettings AuthenticationSettings;</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ApiKeyAuthenticationHandler</span>(<span class="hljs-params"></span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">        IOptionsMonitor&lt;ApiKeyAuthenticationOptions&gt; options,</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        ILoggerFactory logger,</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">        UrlEncoder encoder,</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">        ISystemClock clock,</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">        IOptions&lt;AuthenticationSettings&gt; authenticationSettings</span>) : <span class="hljs-title">base</span>(<span class="hljs-params">options, logger, encoder, clock</span>)</span></span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">        AuthenticationSettings = authenticationSettings.Value;</span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> Task&lt;AuthenticateResult&gt; <span class="hljs-title">HandleAuthenticateAsync</span>()</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">        <span class="hljs-keyword">if</span> (!Request.Headers.TryGetValue(AuthenticationHeaderName, <span class="hljs-keyword">out</span> <span class="hljs-keyword">var</span> apiKeyHeaderValues))</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">21</span><span class="line-content">            <span class="hljs-keyword">return</span> Task.FromResult(AuthenticateResult.NoResult());</span></span>
<span class="code-line"><span class="line-number">22</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">23</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">24</span><span class="line-content">        <span class="hljs-keyword">var</span> providedApiKey = apiKeyHeaderValues.FirstOrDefault();</span></span>
<span class="code-line"><span class="line-number">25</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">26</span><span class="line-content">        <span class="hljs-keyword">if</span> (apiKeyHeaderValues.Count == <span class="hljs-number">0</span> || <span class="hljs-built_in">string</span>.IsNullOrWhiteSpace(providedApiKey))</span></span>
<span class="code-line"><span class="line-number">27</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">28</span><span class="line-content">            <span class="hljs-keyword">return</span> Task.FromResult(AuthenticateResult.NoResult());</span></span>
<span class="code-line"><span class="line-number">29</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">30</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">31</span><span class="line-content">        <span class="hljs-keyword">var</span> isMatchingKey = providedApiKey.Equals(AuthenticationSettings.AuthenticationToken);</span></span>
<span class="code-line"><span class="line-number">32</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">33</span><span class="line-content">        <span class="hljs-keyword">if</span> (isMatchingKey)</span></span>
<span class="code-line"><span class="line-number">34</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">35</span><span class="line-content">            <span class="hljs-keyword">var</span> claims = <span class="hljs-keyword">new</span> List&lt;Claim&gt; {</span></span>
<span class="code-line"><span class="line-number">36</span><span class="line-content">                <span class="hljs-comment">//Add your claims here</span></span></span>
<span class="code-line"><span class="line-number">37</span><span class="line-content">            };</span></span>
<span class="code-line"><span class="line-number">38</span><span class="line-content">            <span class="hljs-keyword">var</span> identity = <span class="hljs-keyword">new</span> ClaimsIdentity(claims, Options.AuthenticationType);</span></span>
<span class="code-line"><span class="line-number">39</span><span class="line-content">            <span class="hljs-keyword">var</span> identities = <span class="hljs-keyword">new</span> List&lt;ClaimsIdentity&gt; { identity };</span></span>
<span class="code-line"><span class="line-number">40</span><span class="line-content">            <span class="hljs-keyword">var</span> principal = <span class="hljs-keyword">new</span> ClaimsPrincipal(identities);</span></span>
<span class="code-line"><span class="line-number">41</span><span class="line-content">            <span class="hljs-keyword">var</span> ticket = <span class="hljs-keyword">new</span> AuthenticationTicket(principal, Options.Scheme);</span></span>
<span class="code-line"><span class="line-number">42</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">43</span><span class="line-content">            <span class="hljs-keyword">return</span> Task.FromResult(AuthenticateResult.Success(ticket));</span></span>
<span class="code-line"><span class="line-number">44</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">45</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">46</span><span class="line-content">        <span class="hljs-keyword">return</span> Task.FromResult(AuthenticateResult.Fail(<span class="hljs-string">&quot;Invalid API Key provided.&quot;</span>));</span></span>
<span class="code-line"><span class="line-number">47</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">48</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">49</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">HandleChallengeAsync</span>(<span class="hljs-params">AuthenticationProperties properties</span>)</span></span></span>
<span class="code-line"><span class="line-number">50</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">51</span><span class="line-content">        Response.StatusCode = (<span class="hljs-built_in">int</span>)HttpStatusCode.Unauthorized;</span></span>
<span class="code-line"><span class="line-number">52</span><span class="line-content">        Response.ContentType = ProblemDetailsContentType;</span></span>
<span class="code-line"><span class="line-number">53</span><span class="line-content">        <span class="hljs-keyword">var</span> problemDetails = <span class="hljs-keyword">new</span> { Information = <span class="hljs-string">&quot;Unauthorized&quot;</span> };</span></span>
<span class="code-line"><span class="line-number">54</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">55</span><span class="line-content">        <span class="hljs-keyword">await</span> Response.WriteAsync(JsonSerializer.Serialize(problemDetails));</span></span>
<span class="code-line"><span class="line-number">56</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">57</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">58</span><span class="line-content">    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">HandleForbiddenAsync</span>(<span class="hljs-params">AuthenticationProperties properties</span>)</span></span></span>
<span class="code-line"><span class="line-number">59</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">60</span><span class="line-content">        Response.StatusCode = (<span class="hljs-built_in">int</span>)HttpStatusCode.Forbidden;</span></span>
<span class="code-line"><span class="line-number">61</span><span class="line-content">        Response.ContentType = ProblemDetailsContentType;</span></span>
<span class="code-line"><span class="line-number">62</span><span class="line-content">        <span class="hljs-keyword">var</span> problemDetails = <span class="hljs-keyword">new</span> { Information = <span class="hljs-string">&quot;Forbidden&quot;</span> };</span></span>
<span class="code-line"><span class="line-number">63</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">64</span><span class="line-content">        <span class="hljs-keyword">await</span> Response.WriteAsync(JsonSerializer.Serialize(problemDetails));</span></span>
<span class="code-line"><span class="line-number">65</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">66</span><span class="line-content">}</span></span></code></pre><p>The final part need is to register this in our startup class, below are the two bits of code needed. Once we have this in place the <code>[Authorize]</code> tag will work for regular REST requests, any request sent without an <code>x-api-key</code> value of &#39;secret123&#39; will be rejected. The next step is to see how we replicate this in GraphQL.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">public void <span class="hljs-built_in">ConfigureServices</span>(IServiceCollection services)</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    ...</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    services<span class="hljs-selector-class">.AddAuthentication</span>(options =&gt;</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">        options.DefaultAuthenticateScheme = ApiKeyAuthenticationOptions.DefaultScheme;</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">        options.DefaultChallengeScheme = ApiKeyAuthenticationOptions.DefaultScheme;</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">    })<span class="hljs-selector-class">.AddScheme</span>&lt;ApiKeyAuthenticationOptions, ApiKeyAuthenticationHandler&gt;(</span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        ApiKeyAuthenticationOptions.DefaultScheme,</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">        null</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">    );</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">    services<span class="hljs-selector-class">.AddAuthorization</span>();</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">}</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content"></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">public void <span class="hljs-built_in">Configure</span>(IApplicationBuilder app, IWebHostEnvironment env)</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">    ...</span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">    app<span class="hljs-selector-class">.UseAuthentication</span>();</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">    app<span class="hljs-selector-class">.UseAuthorization</span>();</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">}</span></span></code></pre><h3>Authenticating a GraphQl Entity</h3>
<p>Authentication in GraphQL works by authorizing individual models, to begin we first need to add the HotChocolate Authorization package <code>HotChocolate.AspNetCore.Authorization</code> and enable it in the <code>Startup.cs</code> class, its a one-liner,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">services<span class="hljs-selector-class">.AddAuthorizeDirectiveType</span>()</span></span></code></pre><p>Now similar to the <code>[Authorize]</code> tag we use for REST we can enable Authorization in for our individual ObjectTypes by adding a simple <code>descriptor.Authorize()</code> call.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">CatType1</span> : <span class="hljs-symbol">ObjectType</span>&lt;<span class="hljs-symbol">CatResponse1</span>&gt;</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-built_in">void</span> Configure(IObjectTypeDescriptor&lt;CatResponse1&gt; descriptor)</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">        descriptor.Authorize();</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">        ...</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">    }</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">}</span></span></code></pre><p>Once this has been added making calls without the header will return an unauthenticated result that looks like this,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">  &quot;errors&quot;: [</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">      &quot;message&quot;: <span class="hljs-string">&quot;The current user is not authorized to access this resource.&quot;</span>,</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">      <span class="hljs-string">&quot;locations&quot;</span>: [</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">          &quot;<span class="hljs-selector-tag">line</span>&quot;: <span class="hljs-number">3</span>,</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">          <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-number">5</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">      ],</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">      &quot;<span class="hljs-selector-tag">path</span>&quot;: [</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">        <span class="hljs-string">&quot;cat1&quot;</span>,</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">        <span class="hljs-number">1</span>,</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">        <span class="hljs-string">&quot;id&quot;</span></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">      ],</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">      <span class="hljs-string">&quot;extensions&quot;</span>: {</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">        &quot;<span class="hljs-selector-tag">code</span>&quot;: <span class="hljs-string">&quot;AUTH_NOT_AUTHENTICATED&quot;</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">      }</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">    },</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">    ...</span></span></code></pre><h2>How to do Authorisation</h2>
<p>Extending the code to work with Authorization is also a quick change, in this example we will authorize based on the user&#39;s role. To begin we will extend our <code>ApiKeyAuthenticationHandler</code> to populate a claim when the authentication key has matched,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content"><span class="hljs-keyword">var</span> claims = <span class="hljs-keyword">new</span> List&lt;Claim&gt; {</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">    <span class="hljs-keyword">new</span> Claim(<span class="hljs-string">&quot;http://schemas.microsoft.com/ws/2008/06/identity/claims/role&quot;</span>, <span class="hljs-string">&quot;Admin&quot;</span>)</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">};</span></span></code></pre><p>Next we can pass a list of accepted roles into the ObjectType <code>CatType1</code>, in this example I have intentionally added a role that doesn&#39;t exist.</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">var roles <span class="hljs-operator">=</span> new string[] { <span class="hljs-string">&quot;NotAdmin&quot;</span> }<span class="hljs-comment">;</span></span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">descriptor.Authorize(roles)<span class="hljs-comment">;</span></span></span></code></pre><p>Making a request now will spark an unauthorized error,</p>
<pre><code class="hljs "><span class="code-line"><span class="line-number">1</span><span class="line-content">{</span></span>
<span class="code-line"><span class="line-number">2</span><span class="line-content">  &quot;errors&quot;: [</span></span>
<span class="code-line"><span class="line-number">3</span><span class="line-content">    {</span></span>
<span class="code-line"><span class="line-number">4</span><span class="line-content">      &quot;message&quot;: <span class="hljs-string">&quot;The current user is not authorized to access this resource.&quot;</span>,</span></span>
<span class="code-line"><span class="line-number">5</span><span class="line-content">      <span class="hljs-string">&quot;locations&quot;</span>: [</span></span>
<span class="code-line"><span class="line-number">6</span><span class="line-content">        {</span></span>
<span class="code-line"><span class="line-number">7</span><span class="line-content">          &quot;<span class="hljs-selector-tag">line</span>&quot;: <span class="hljs-number">3</span>,</span></span>
<span class="code-line"><span class="line-number">8</span><span class="line-content">          <span class="hljs-string">&quot;column&quot;</span>: <span class="hljs-number">5</span></span></span>
<span class="code-line"><span class="line-number">9</span><span class="line-content">        }</span></span>
<span class="code-line"><span class="line-number">10</span><span class="line-content">      ],</span></span>
<span class="code-line"><span class="line-number">11</span><span class="line-content">      &quot;<span class="hljs-selector-tag">path</span>&quot;: [</span></span>
<span class="code-line"><span class="line-number">12</span><span class="line-content">        <span class="hljs-string">&quot;cat1&quot;</span>,</span></span>
<span class="code-line"><span class="line-number">13</span><span class="line-content">        <span class="hljs-number">1</span>,</span></span>
<span class="code-line"><span class="line-number">14</span><span class="line-content">        <span class="hljs-string">&quot;id&quot;</span></span></span>
<span class="code-line"><span class="line-number">15</span><span class="line-content">      ],</span></span>
<span class="code-line"><span class="line-number">16</span><span class="line-content">      <span class="hljs-string">&quot;extensions&quot;</span>: {</span></span>
<span class="code-line"><span class="line-number">17</span><span class="line-content">        &quot;<span class="hljs-selector-tag">code</span>&quot;: <span class="hljs-string">&quot;AUTH_NOT_AUTHORIZED&quot;</span></span></span>
<span class="code-line"><span class="line-number">18</span><span class="line-content">      }</span></span>
<span class="code-line"><span class="line-number">19</span><span class="line-content">    },</span></span>
<span class="code-line"><span class="line-number">20</span><span class="line-content">    ...</span></span></code></pre><h2>How does logging work</h2>
<p>Regarding logging Chilli Cream has created a guide to adding an <code>AddDiagnosticEventListener</code> that&#39;s able to trace incoming requests, check out the article <a href="https://chillicream.com/blog/2021/01/10/hot-chocolate-logging">Log Your Queries While Building a GraphQL Server</a>. It would be interesting to create an example that&#39;s <code>OpenTelemetry</code> compliant... perhaps that&#39;s one for another day (this articles getting a bit long üò©).</p>
<h1>Conclusion</h1>
<p>That&#39;s it folks! We&#39;ve seen that the Hot Chocolate implementation nicely fulfils not just the 80% crud use case but can also deal with the other responsibilities we typically see with our REST services in the wild.</p>
</div><div class="ShareButtons-module__iQZDeW__container"><div class="ShareButtons-module__iQZDeW__label">Share this article</div><div class="ShareButtons-module__iQZDeW__buttons"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate&amp;text=ASP.NET%20GraphQL%20server%20with%20Hot%20Chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__twitter" aria-label="Share on Twitter"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__linkedin" aria-label="Share on LinkedIn"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__facebook" aria-label="Share on Facebook"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a><a href="https://reddit.com/submit?url=https%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate&amp;title=ASP.NET%20GraphQL%20server%20with%20Hot%20Chocolate" target="_blank" rel="noopener noreferrer" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__reddit" aria-label="Share on Reddit"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"></path></svg></a><a href="mailto:?subject=ASP.NET%20GraphQL%20server%20with%20Hot%20Chocolate&amp;body=%23%20Starting%20my%20journey%20with%20GraphQL%0A%0AUp%20till%20now%2C%20I&#x27;ve%20always%20heavily%20relied%20on%20RESTfull%20services%20to%20power%20API&#x27;s%2C%20this%20recently%20got%20widened%20with%20GRPC%20which%20you%20c%0A%0Ahttps%3A%2F%2Fwww.faesel.com%2Fblog%2Faspnet-graphql-server-with-hot-chocolate" class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__email" aria-label="Share via Email"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a><button class="ShareButtons-module__iQZDeW__button ShareButtons-module__iQZDeW__copy " aria-label="Copy link"><svg viewBox="0 0 24 24" class="ShareButtons-module__iQZDeW__icon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg></button></div></div></article><!--$--><!--/$--></main><footer class="Footer-module__S6Hkya__footer"><div class="Footer-module__S6Hkya__container"><div class="Footer-module__S6Hkya__content"><nav class="Footer-module__S6Hkya__links" aria-label="Footer navigation"><a class="Footer-module__S6Hkya__link" href="/blog">Blog</a><a class="Footer-module__S6Hkya__link" href="/projects">Projects</a><a class="Footer-module__S6Hkya__link" href="/about">About</a><a class="Footer-module__S6Hkya__link" href="/contact">Contact</a></nav><p class="Footer-module__S6Hkya__copyright">¬© <!-- -->2026<!-- --> All rights reserved.</p></div></div></footer><script src="/_next/static/chunks/ba947f6798c3c403.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[31362,[\"/_next/static/chunks/8be72f203fe36d6f.js\"],\"default\"]\n3:I[2971,[\"/_next/static/chunks/8be72f203fe36d6f.js\"],\"default\"]\n4:I[39756,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"default\"]\n5:I[37457,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"default\"]\n6:I[22016,[\"/_next/static/chunks/8be72f203fe36d6f.js\",\"/_next/static/chunks/34e59d4fa8652639.js\"],\"\"]\n8:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"OutletBoundary\"]\n9:\"$Sreact.suspense\"\nb:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"ViewportBoundary\"]\nd:I[97367,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"MetadataBoundary\"]\nf:I[68027,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"default\"]\n:HL[\"/_next/static/chunks/19d110f125a6a880.css\",\"style\"]\n:HL[\"/_next/static/chunks/4c98436a675d5713.css\",\"style\"]\n:HL[\"/_next/static/chunks/578ca6ed020117e9.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"Oqm01v-5exOWumYC57wkW\",\"c\":[\"\",\"blog\",\"aspnet-graphql-server-with-hot-chocolate\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"aspnet-graphql-server-with-hot-chocolate\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/19d110f125a6a880.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/8be72f203fe36d6f.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"Organization\\\",\\\"name\\\":\\\"Faesel Saeed\\\",\\\"url\\\":\\\"https://www.faesel.com\\\",\\\"logo\\\":{\\\"@type\\\":\\\"ImageObject\\\",\\\"url\\\":\\\"https://www.faesel.com/images/logo.png\\\"},\\\"sameAs\\\":[\\\"https://github.com/faesel\\\",\\\"https://www.linkedin.com/in/faesel-saeed-a97b1614\\\"]}\"}}],[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"WebSite\\\",\\\"name\\\":\\\"FAESEL.COM\\\",\\\"url\\\":\\\"https://www.faesel.com\\\",\\\"description\\\":\\\"A modern tech blog exploring technology, coding, and digital innovation\\\",\\\"publisher\\\":{\\\"@type\\\":\\\"Organization\\\",\\\"name\\\":\\\"Faesel Saeed\\\",\\\"url\\\":\\\"https://www.faesel.com\\\"}}\"}}]]}],[\"$\",\"body\",null,{\"children\":[[\"$\",\"$L2\",null,{\"gaId\":\"G-Y039CLFJME\"}],[\"$\",\"a\",null,{\"href\":\"#main-content\",\"className\":\"skip-to-content\",\"children\":\"Skip to content\"}],[\"$\",\"$L3\",null,{}],[\"$\",\"main\",null,{\"id\":\"main-content\",\"style\":{\"minHeight\":\"70vh\"},\"children\":[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"not-found-module__HS70Aa__container\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"not-found-module__HS70Aa__title\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"not-found-module__HS70Aa__subtitle\",\"children\":\"Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"not-found-module__HS70Aa__message\",\"children\":\"Sorry, the page you're looking for doesn't exist.\"}],[\"$\",\"$L6\",null,{\"href\":\"/\",\"className\":\"not-found-module__HS70Aa__homeLink\",\"children\":\"Go Home\"}]]}],[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/578ca6ed020117e9.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"Footer-module__S6Hkya__footer\",\"children\":[\"$\",\"div\",null,{\"className\":\"Footer-module__S6Hkya__container\",\"children\":[\"$\",\"div\",null,{\"className\":\"Footer-module__S6Hkya__content\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"Footer-module__S6Hkya__links\",\"aria-label\":\"Footer navigation\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/blog\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"Blog\"}],[\"$\",\"$L6\",null,{\"href\":\"/projects\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"Projects\"}],[\"$\",\"$L6\",null,{\"href\":\"/about\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"About\"}],[\"$\",\"$L6\",null,{\"href\":\"/contact\",\"className\":\"Footer-module__S6Hkya__link\",\"children\":\"Contact\"}]]}],[\"$\",\"p\",null,{\"className\":\"Footer-module__S6Hkya__copyright\",\"children\":[\"¬© \",2026,\" All rights reserved.\"]}]]}]}]}]]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L7\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/4c98436a675d5713.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/34e59d4fa8652639.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L8\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@a\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$9\",null,{\"name\":\"Next.Metadata\",\"children\":\"$Le\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$f\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"11:I[5500,[\"/_next/static/chunks/8be72f203fe36d6f.js\",\"/_next/static/chunks/34e59d4fa8652639.js\"],\"Image\"]\n15:I[27201,[\"/_next/static/chunks/ff1a16fafef87110.js\",\"/_next/static/chunks/708205fa81a1891d.js\"],\"IconMark\"]\n10:T450,{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"ASP.NET GraphQL server with Hot Chocolate\",\"description\":\"# Starting my journey with GraphQL\\n\\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c\",\"image\":\"https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg\",\"datePublished\":\"2021-04-05T00:00+01:00\",\"dateModified\":\"2021-04-05T00:00+01:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Faesel Saeed\",\"url\":\"https://www.faesel.com/about\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Faesel Saeed\",\"url\":\"https://www.faesel.com\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https://www.faesel.com/images/logo.png\"}},\"keywords\":\"graphql, hotchocolate, graphql-voyager, asp.net, authentication, authorization, versioning, rest, chilli-cream, logging, open-telemetry, banana-cake-pop\",\"url\":\"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate\"}}"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"$10\"}}],[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BreadcrumbList\\\",\\\"itemListElement\\\":[{\\\"@type\\\":\\\"ListItem\\\",\\\"position\\\":1,\\\"name\\\":\\\"Home\\\",\\\"item\\\":\\\"https://www.faesel.com\\\"},{\\\"@type\\\":\\\"ListItem\\\",\\\"position\\\":2,\\\"name\\\":\\\"Blog\\\",\\\"item\\\":\\\"https://www.faesel.com/blog\\\"},{\\\"@type\\\":\\\"ListItem\\\",\\\"position\\\":3,\\\"name\\\":\\\"ASP.NET GraphQL server with Hot Chocolate\\\",\\\"item\\\":\\\"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate\\\"}]}\"}}],[\"$\",\"article\",null,{\"className\":\"page-module__dgei_G__article\",\"children\":[[\"$\",\"$L6\",null,{\"href\":\"/blog\",\"className\":\"page-module__dgei_G__backLink\",\"children\":\"‚Üê Back to Blog\"}],[\"$\",\"header\",null,{\"className\":\"page-module__dgei_G__header\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"page-module__dgei_G__title\",\"children\":\"ASP.NET GraphQL server with Hot Chocolate\"}],[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__meta\",\"children\":[[\"$\",\"time\",null,{\"className\":\"page-module__dgei_G__date\",\"dateTime\":\"2021-04-05T00:00+01:00\",\"children\":[\"üìÖ \",\"April 4, 2021\"]}],[\"$\",\"span\",null,{\"className\":\"page-module__dgei_G__separator\",\"children\":\"‚Ä¢\"}],[\"$\",\"span\",null,{\"className\":\"page-module__dgei_G__readingTime\",\"children\":[\"‚è±Ô∏è \",\"10 min read\"]}]]}],[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__tags\",\"children\":[[\"$\",\"span\",\"graphql-0\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"graphql\"}],[\"$\",\"span\",\"hotchocolate-1\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"hotchocolate\"}],[\"$\",\"span\",\"graphql-voyager-2\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"graphql-voyager\"}],[\"$\",\"span\",\"asp.net-3\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"asp.net\"}],[\"$\",\"span\",\"authentication-4\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"authentication\"}],[\"$\",\"span\",\"authorization-5\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"authorization\"}],[\"$\",\"span\",\"versioning-6\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"versioning\"}],[\"$\",\"span\",\"rest-7\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"rest\"}],[\"$\",\"span\",\"chilli-cream-8\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"chilli-cream\"}],[\"$\",\"span\",\"logging-9\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"logging\"}],[\"$\",\"span\",\"open-telemetry-10\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"open-telemetry\"}],[\"$\",\"span\",\"banana-cake-pop-11\",{\"className\":\"page-module__dgei_G__tag\",\"children\":\"banana-cake-pop\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__heroImage\",\"children\":[\"$\",\"$L11\",null,{\"src\":\"https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg\",\"alt\":\"ASP.NET GraphQL server with Hot Chocolate\",\"fill\":true,\"className\":\"page-module__dgei_G__heroImageImg\",\"priority\":true,\"sizes\":\"(max-width: 800px) 100vw, 800px\"}]}],\"$L12\",\"$L13\",\"$L14\"]}]]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"title\",\"0\",{\"children\":\"ASP.NET GraphQL server with Hot Chocolate | Tech Blog | FAESEL.COM\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"# Starting my journey with GraphQL\\n\\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c\"}],[\"$\",\"link\",\"2\",{\"rel\":\"author\",\"href\":\"https://www.faesel.com/about\"}],[\"$\",\"meta\",\"3\",{\"name\":\"author\",\"content\":\"Faesel Saeed\"}],[\"$\",\"meta\",\"4\",{\"name\":\"keywords\",\"content\":\"graphql,hotchocolate,graphql-voyager,asp.net,authentication,authorization,versioning,rest,chilli-cream,logging,open-telemetry,banana-cake-pop\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"ASP.NET GraphQL server with Hot Chocolate\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"# Starting my journey with GraphQL\\n\\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:image\",\"content\":\"https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"9\",{\"property\":\"article:published_time\",\"content\":\"2021-04-05T00:00+01:00\"}],[\"$\",\"meta\",\"10\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"11\",{\"name\":\"twitter:site\",\"content\":\"@faeselsaeed\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:creator\",\"content\":\"@faeselsaeed\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\"ASP.NET GraphQL server with Hot Chocolate\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"# Starting my journey with GraphQL\\n\\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image\",\"content\":\"https://images.ctfassets.net/wjg1udsw901v/74JrRnpexhOnSAsBwNOPV7/635bc389cea0de36f3158df45483ae85/graphql.jpg\"}],[\"$\",\"link\",\"16\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",\"17\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"link\",\"18\",{\"rel\":\"apple-touch-icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"$L15\",\"19\",{}]]\n"])</script><script>self.__next_f.push([1,"16:I[23150,[\"/_next/static/chunks/8be72f203fe36d6f.js\",\"/_next/static/chunks/34e59d4fa8652639.js\"],\"default\"]\n12:[\"$\",\"$L16\",null,{\"url\":\"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate\",\"title\":\"ASP.NET GraphQL server with Hot Chocolate\",\"description\":\"# Starting my journey with GraphQL\\n\\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c\",\"variant\":\"sidebar\"}]\n17:Tddcd,"])</script><script>self.__next_f.push([1,"\u003ch1\u003eStarting my journey with GraphQL\u003c/h1\u003e\n\u003cp\u003eUp till now, I\u0026#39;ve always heavily relied on RESTfull services to power API\u0026#39;s, this recently got widened with GRPC which you can read about in my article \u003ca href=\"https://www.faesel.com/blog/dotnet-grpc-forgot-to-tell-you\"\u003e.NET \u0026amp; GRPC What they forgot to tell you\u003c/a\u003e. GraphQL was the third final frontier that needed exploring ü•æ...until now.\u003c/p\u003e\n\u003cp\u003eHaving looked at it a year back the implementations for .NET were in their infancy, which meant that your server would only be as good as the framework you choose. Fast forward to 2021, \u003ca href=\"https://github.com/ChilliCream/hotchocolate\"\u003eChilli Creams Hotchocolate\u003c/a\u003e has gained some serious ground and makes GraphQL an appealing proposition for developers.\u003c/p\u003e\n\u003cp\u003eIn this article I hope to cover two main points,\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHow REST is designed to break backend engineers\u003c/li\u003e\n\u003cli\u003eHow GraphQL saves the day\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003eYour typical REST scenario\u003c/h1\u003e\n\u003cp\u003eLet\u0026#39;s paint the scene, your a backend engineer who\u0026#39;s creating an endpoint for showing a list of cats. With your battle-tested REST knowledge, you set out to create your first basic endpoint in the \u003ccode\u003eCatsController\u003c/code\u003e that returns all cats and the front end engineer is ready to integrate it into his UI.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-comment\"\u003e// api/cats\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e[\u003cspan class=\"hljs-meta\"\u003eHttpGet\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e Task\u0026lt;IActionResult\u0026gt; \u003cspan class=\"hljs-title\"\u003eGetCats\u003c/span\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e context = contextFactory.CreateDbContext())\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e cats = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e context.Cats.ToListAsync();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e(cat != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Ok(cats);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e NoContent();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe app soon becomes a hit! your product manager decides to expand the functionality to filter by cat descriptions and to create a new cat information page. Getting to work you expand the endpoints for the front end engineers to use.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-comment\"\u003e//api/cats/1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e[\u003cspan class=\"hljs-meta\"\u003eHttpGet\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e[\u003cspan class=\"hljs-meta\"\u003eRoute(\u003cspan class=\"hljs-string\"\u003e\u0026quot;{id}\u0026quot;\u003c/span\u003e)\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e Task\u0026lt;IActionResult\u0026gt; \u003cspan class=\"hljs-title\"\u003eGetCatsById\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e[FromRoute] \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e id\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e context = contextFactory.CreateDbContext())\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e cats = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e context.Cats.FirstOrDefaultAsync(x =\u0026gt; x.Id == id);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e(cats != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Ok(cats);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e NoContent();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-comment\"\u003e// api/cats/description/brown\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e[\u003cspan class=\"hljs-meta\"\u003eHttpGet\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e[\u003cspan class=\"hljs-meta\"\u003eRoute(\u003cspan class=\"hljs-string\"\u003e\u0026quot;description/{description}\u0026quot;\u003c/span\u003e)\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e Task\u0026lt;IActionResult\u0026gt; \u003cspan class=\"hljs-title\"\u003eGetCatsByDescription\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e[FromRoute] \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e description\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e21\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e22\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eusing\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e context = contextFactory.CreateDbContext())\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e23\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e24\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e cats = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e context.Cats.Where(x =\u0026gt; x.Description.Contains(description)).ToListAsync();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e25\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e26\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e(cats != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e27\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Ok(payload);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e28\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e29\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e30\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e NoContent();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e31\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe cycle continues with product owners coming up with more feature requests and at the bottom of the pile, you got the backend engineer being reactive to all the changes. By the time you\u0026#39;ve wrapped up the project your left with a code smell of 10+ endpoints üí©.\u003c/p\u003e\n\u003cp\u003eThe situation further degrades after a year when the UI gets redesigned and features are culled based on user usage. You end up with random floating endpoints because quite frankly no one audits their endpoints for dead code.\u003c/p\u003e\n\u003cp\u003eThis is where GraphQL steps in, it switches the responsibility of an engineer from anticipating and creating endpoints to simply upfront displaying everything that\u0026#39;s available with declarative meaning.\u003c/p\u003e\n\u003ch1\u003eHot Chocolate (.NET GraphQL server framework)\u003c/h1\u003e\n\u003cp\u003eHot chocolate is one of the leading implementations of a GraphQL server, one important thing to note when choosing a framework is that your implementation will only be as good as the framework you choose. As the \u003ca href=\"http://spec.graphql.org/\"\u003eGraphQL specification\u003c/a\u003e progresses you want a framework that keeps up to date with the changes... Hot Chocolate does that.\u003c/p\u003e\n\u003cp\u003eTo understand the basics of Hot Chocolate I recommend \u003ca href=\"https://www.youtube.com/user/binarythistle\"\u003e\u003cstrong\u003eLes Jackson\u0026#39;s\u003c/strong\u003e\u003c/a\u003e free course on youtube. It is a bit lengthy at 3 Hours and 45 Minutes but it allows you to create an ASP.NET implementation from scratch and understand basic concepts like Querys, Mutations and Subscriptions. By the end of the course, you have a GraphQL service that can do CRUD actions (do üëç his video it\u0026#39;s great!).\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.youtube.com/watch?v=HuN94qNwQmM\"\u003ehttps://www.youtube.com/watch?v=HuN94qNwQmM\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe source code he produces can also be found on his \u003ca href=\"https://github.com/binarythistle/S04E01---.NET-5-GraphQL-API\"\u003egithub repo\u003c/a\u003e. The source code is a great starting point as it creates a docker image containing an MSSQL database. The solution itself already has Entity Framework and Hot Chocolate bootstrapped, with two entities to test with.\u003c/p\u003e\n\u003cp\u003eOn top of this \u003ca href=\"https://github.com/ChilliCream/hotchocolate/blob/main/src/BananaCakePop\"\u003eBanana Cake Pop üçå\u003c/a\u003e is also integrated which allows you to query your server through a browser (similar to swagger).\u003c/p\u003e\n\u003cp\u003eAs well as \u003ca href=\"https://github.com/APIs-guru/graphql-voyager\"\u003eGraphQL Voyager üöÄ\u003c/a\u003e (do checkout the \u003ca href=\"https://apis.guru/graphql-voyager/\"\u003elive demo\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eTo understand the remainder of the article it\u0026#39;s important to have some basic knowledge of Hot Chocolate.\u003c/p\u003e\n\u003ch1\u003eGraphQl Voyager\u003c/h1\u003e\n\u003cp\u003eWhilst this is an addition to what\u0026#39;s being discussed, it\u0026#39;s worth briefly mentioning. Voyager helps facilitate the move of a backend engineer from creating and documenting prescriptive REST endpoints to simply becoming a harbour of documentation and entities.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe marker of a quality API has shifted from creating a subjectively RESTfull API and how well it\u0026#39;s documented to ... just how well it\u0026#39;s documented üìù.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eHere\u0026#39;s a taste of what is looks like for our API,\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"//images.ctfassets.net/wjg1udsw901v/8f7Kb65mDXS5ZBSA4At50/08bcdb6bfe661bdb50965e7b9e8d5a81/graphql-voyager.png\" alt=\"Graphql Voyager\"\u003e\u003c/p\u003e\n\u003ch1\u003eWhat they forgot to mention\u003c/h1\u003e\n\u003cp\u003eUp till now what we have discussed fits the 80% CRUD usecase, however as we know API\u0026#39;s that are in the wild also deal with a range of other responsibilities. The remainder of this article is to shed some light on how this is done.\u003c/p\u003e\n\u003ch2\u003eHow to version your API\u003c/h2\u003e\n\u003cp\u003eThe typical versioning strategy for REST is to version using URLs \u003ccode\u003ehttps://api.cats.com/v1\u003c/code\u003e (when developers can be bothered). However with GraphQL as your only ever posting to a single endpoint that strategy is no longer a prefered solution.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhile there\u0026#39;s nothing that prevents a GraphQL service from being versioned just like any other REST API, GraphQL takes a strong opinion on avoiding versioning by providing the tools for the continuous evolution of a GraphQL schema.\u003cbr\u003e\u003cem\u003e\u003ca href=\"https://graphql.org/learn/best-practices/\"\u003eTaken from GraphQL Best Practices\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eBefore we begin on how to version, there are some distinct points to note.\u003c/p\u003e\n\u003cp\u003eNon-breaking changes can continue as they would with REST, adding properties to entities (as you would with response models in REST), continues to be a way to evolve your API. Similarly adding new query types to your GraphQL server is also deemed as a non-breaking change, and is equivalent to adding new endpoints in REST.\u003c/p\u003e\n\u003cp\u003eGraphQL aids in breaking changes caused due to nullability as \u003cstrong\u003eeverything\u003c/strong\u003e unless specified is treated as nullable. This leads to upfront resilience on the front end to missing data, the \u003ccode\u003eid: Int!\u003c/code\u003e in the example below cannot be null.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eCats\u003c/span\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  id: \u003cspan class=\"hljs-type\"\u003eInt\u003c/span\u003e!\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  name: \u003cspan class=\"hljs-type\"\u003eString\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eEventually, we do still hit circumstances where a breaking change is needed. In these situations we have two strategies. The first as \u003ca href=\"https://chillicream.com/docs/hotchocolate/defining-a-schema/versioning/\"\u003eChilli Cream Docs\u003c/a\u003e specify is to add deprecated flags to old properties and begin to shift usage to new versions.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003epublic class CatsType : ObjectType\u0026lt;Cats\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e override \u003cspan class=\"hljs-type\"\u003evoid\u003c/span\u003e Configure(IObjectTypeDescriptor\u0026lt;Cats\u0026gt; descriptor)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Represents commands available on a platform\u0026quot;\u003c/span\u003e)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Field(\u003cspan class=\"hljs-keyword\"\u003ex\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"hljs-keyword\"\u003ex\u003c/span\u003e.Name).Deprecated(\u003cspan class=\"hljs-string\"\u003e\u0026quot;This is no longer used, use FirstName and LastName\u0026quot;\u003c/span\u003e)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Field(\u003cspan class=\"hljs-keyword\"\u003ex\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"hljs-keyword\"\u003ex\u003c/span\u003e.FirstName)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Field(\u003cspan class=\"hljs-keyword\"\u003ex\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e\u0026gt; \u003cspan class=\"hljs-keyword\"\u003ex\u003c/span\u003e.LastName)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eFor client developers, this then creates warnings when using a deprecated property.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"//images.ctfassets.net/wjg1udsw901v/2BkWWBcz1UAAU9fFVavBGQ/c812ee032ddcd8eb600b165616f68e5b/Screenshot_2021-03-26_153337.png\" alt=\"Depricated GraphQL property\"\u003e\u003c/p\u003e\n\u003cp\u003eWhilst this approach works over time it could create a lot of noise if you have many deprecated properties, an alternative approach is to split the entity entirely, use different classes between the two versions. Here is an example, we start by creating two query types,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003erecord\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eCatResponse1\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e Id, \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e Name\u003c/span\u003e)\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003erecord\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eCatResponse2\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e Id, \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e FirstName, \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e LastName\u003c/span\u003e)\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBoth of these would contain their own Code First type files\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eCatType1\u003c/span\u003e : \u003cspan class=\"hljs-title\"\u003eObjectType\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title\"\u003eCatResponse1\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eConfigure\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eIObjectTypeDescriptor\u0026lt;CatResponse1\u0026gt; descriptor\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Represents cats!\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Field(x =\u0026gt; x.Name)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            .Description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Represents the name of the cat\u0026quot;\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            .Deprecated(\u003cspan class=\"hljs-string\"\u003e\u0026quot;This is no longer used, use FirstName and LastName from Cat2\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eCatType2\u003c/span\u003e : \u003cspan class=\"hljs-title\"\u003eObjectType\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title\"\u003eCatResponse2\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eConfigure\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eIObjectTypeDescriptor\u0026lt;CatResponse2\u0026gt; descriptor\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Represents cats!\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Field(x =\u0026gt; x.FirstName)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            .Description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Represents the name firstname of the cat\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e21\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Field(x =\u0026gt; x.LastName)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e22\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            .Description(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Represents the name lastname of the cat\u0026quot;\u003c/span\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e23\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e24\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe final piece of code is to use the intermediary response models. Under the hood we are still using the same EF entity.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eQuery\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    [\u003cspan class=\"hljs-meta\"\u003eUseDbContext(typeof(AppDbContext))\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    [\u003cspan class=\"hljs-meta\"\u003eUseFiltering\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    [\u003cspan class=\"hljs-meta\"\u003eUseSorting\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e IQueryable\u0026lt;CatResponse1\u0026gt; \u003cspan class=\"hljs-title\"\u003eGetCat1\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e[ScopedService] AppDbContext context\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e cats = context.Cats;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e cats.Select(x =\u0026gt; \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e CatResponse1(x.Id, x.Name));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    [\u003cspan class=\"hljs-meta\"\u003eUseDbContext(typeof(AppDbContext))\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    [\u003cspan class=\"hljs-meta\"\u003eUseFiltering\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    [\u003cspan class=\"hljs-meta\"\u003eUseSorting\u003c/span\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e IQueryable\u0026lt;CatResponse2\u0026gt; \u003cspan class=\"hljs-title\"\u003eGetCat2\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e[ScopedService] AppDbContext context\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e cats = context.Cats;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e cats.Select(x =\u0026gt; \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e CatResponse2(x.Id, x.FirstName, x.LastName));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e21\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e22\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e23\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThese changes now allow us to split our models, the two can be queried independently.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"//images.ctfassets.net/wjg1udsw901v/4RSPAHISSIpKS3qFfZbRq1/b53386073d0e86bc0e14a95b30ff857a/versioned-entities.png\" alt=\"Versioned types\"\u003e\u003c/p\u003e\n\u003ch2\u003eHow to do Authentication\u003c/h2\u003e\n\u003cp\u003eSince Hot Chocolate works on top of ASP.NET we can leverage on all the traditional Authentication pipelines we use for REST, nothing changes! To demonstrate this I\u0026#39;m going to extend the base implementation with a basic authentication mechanism using a header value \u003ccode\u003ex-api-key\u003c/code\u003e and a key defined in the \u003ccode\u003eappsettings.json\u003c/code\u003e.\u003c/p\u003e\n\u003ch3\u003eAdding key-based authentication\u003c/h3\u003e\n\u003cp\u003eTo begin let\u0026#39;s first add basic app settings to hold our authentication key (this represents the key the client will pass to the server to authentication their request), and create a class to deserialise into using \u003ccode\u003eIOptions\u003c/code\u003e interface.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e//Code goes \u003cspan class=\"hljs-keyword\"\u003einto\u003c/span\u003e appsettings.json\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u0026quot;AuthenticationSettings\u0026quot;: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u0026quot;AuthenticationToken\u0026quot;: \u0026quot;secret123\u0026quot;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e//\u003cspan class=\"hljs-built_in\"\u003eNew\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eto\u003c/span\u003e serialize \u003cspan class=\"hljs-keyword\"\u003einto\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-built_in\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e AuthenticationSettings\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-built_in\"\u003epublic\u003c/span\u003e string AuthenticationToken { \u003cspan class=\"hljs-keyword\"\u003eget\u003c/span\u003e; \u003cspan class=\"hljs-keyword\"\u003eset\u003c/span\u003e; }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e//Register the \u003cspan class=\"hljs-keyword\"\u003econfiguration\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e Startup.cs \u0026gt; ConfigureServices \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003eservices.Configure\u0026lt;AuthenticationSettings\u0026gt;(\u003cspan class=\"hljs-keyword\"\u003eConfiguration\u003c/span\u003e.GetSection(nameof(AuthenticationSettings)));\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNext we will create authentication scheme options as follows,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003eApiKeyAuthenticationOptions\u003c/span\u003e : \u003cspan class=\"hljs-symbol\"\u003eAuthenticationSchemeOptions\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e DefaultScheme = \u003cspan class=\"hljs-string\"\u003e\u0026quot;KeyBasedScheme\u0026quot;\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e Scheme =\u0026gt; DefaultScheme;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e AuthenticationType = DefaultScheme;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe next part is where the crux of the code is, the \u003ccode\u003eAuthenticationHandler\u003c/code\u003e is what determines whether the request was correctly authenticated. On a successful attempt, it populates the ClaimsPrinciple.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eApiKeyAuthenticationHandler\u003c/span\u003e : \u003cspan class=\"hljs-title\"\u003eAuthenticationHandler\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title\"\u003eApiKeyAuthenticationOptions\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e ProblemDetailsContentType = \u003cspan class=\"hljs-string\"\u003e\u0026quot;application/problem+json\u0026quot;\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e AuthenticationHeaderName = \u003cspan class=\"hljs-string\"\u003e\u0026quot;x-api-key\u0026quot;\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ereadonly\u003c/span\u003e AuthenticationSettings AuthenticationSettings;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eApiKeyAuthenticationHandler\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        IOptionsMonitor\u0026lt;ApiKeyAuthenticationOptions\u0026gt; options,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        ILoggerFactory logger,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        UrlEncoder encoder,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        ISystemClock clock,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        IOptions\u0026lt;AuthenticationSettings\u0026gt; authenticationSettings\u003c/span\u003e) : \u003cspan class=\"hljs-title\"\u003ebase\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eoptions, logger, encoder, clock\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        AuthenticationSettings = authenticationSettings.Value;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e Task\u0026lt;AuthenticateResult\u0026gt; \u003cspan class=\"hljs-title\"\u003eHandleAuthenticateAsync\u003c/span\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!Request.Headers.TryGetValue(AuthenticationHeaderName, \u003cspan class=\"hljs-keyword\"\u003eout\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e apiKeyHeaderValues))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e21\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Task.FromResult(AuthenticateResult.NoResult());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e22\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e23\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e24\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e providedApiKey = apiKeyHeaderValues.FirstOrDefault();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e25\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e26\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (apiKeyHeaderValues.Count == \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e || \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e.IsNullOrWhiteSpace(providedApiKey))\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e27\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e28\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Task.FromResult(AuthenticateResult.NoResult());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e29\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e30\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e31\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e isMatchingKey = providedApiKey.Equals(AuthenticationSettings.AuthenticationToken);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e32\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e33\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isMatchingKey)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e34\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e35\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e claims = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e List\u0026lt;Claim\u0026gt; {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e36\u003c/span\u003e\u003cspan class=\"line-content\"\u003e                \u003cspan class=\"hljs-comment\"\u003e//Add your claims here\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e37\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e38\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e identity = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ClaimsIdentity(claims, Options.AuthenticationType);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e39\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e identities = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e List\u0026lt;ClaimsIdentity\u0026gt; { identity };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e40\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e principal = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ClaimsPrincipal(identities);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e41\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e ticket = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e AuthenticationTicket(principal, Options.Scheme);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e42\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e43\u003c/span\u003e\u003cspan class=\"line-content\"\u003e            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Task.FromResult(AuthenticateResult.Success(ticket));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e44\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e45\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e46\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Task.FromResult(AuthenticateResult.Fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Invalid API Key provided.\u0026quot;\u003c/span\u003e));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e47\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e48\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e49\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e Task \u003cspan class=\"hljs-title\"\u003eHandleChallengeAsync\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eAuthenticationProperties properties\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e50\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e51\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        Response.StatusCode = (\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e)HttpStatusCode.Unauthorized;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e52\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        Response.ContentType = ProblemDetailsContentType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e53\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e problemDetails = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e { Information = \u003cspan class=\"hljs-string\"\u003e\u0026quot;Unauthorized\u0026quot;\u003c/span\u003e };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e54\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e55\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e Response.WriteAsync(JsonSerializer.Serialize(problemDetails));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e56\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e57\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e58\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e Task \u003cspan class=\"hljs-title\"\u003eHandleForbiddenAsync\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eAuthenticationProperties properties\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e59\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e60\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        Response.StatusCode = (\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e)HttpStatusCode.Forbidden;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e61\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        Response.ContentType = ProblemDetailsContentType;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e62\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e problemDetails = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e { Information = \u003cspan class=\"hljs-string\"\u003e\u0026quot;Forbidden\u0026quot;\u003c/span\u003e };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e63\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e64\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e Response.WriteAsync(JsonSerializer.Serialize(problemDetails));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e65\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e66\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe final part need is to register this in our startup class, below are the two bits of code needed. Once we have this in place the \u003ccode\u003e[Authorize]\u003c/code\u003e tag will work for regular REST requests, any request sent without an \u003ccode\u003ex-api-key\u003c/code\u003e value of \u0026#39;secret123\u0026#39; will be rejected. The next step is to see how we replicate this in GraphQL.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003epublic void \u003cspan class=\"hljs-built_in\"\u003eConfigureServices\u003c/span\u003e(IServiceCollection services)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    services\u003cspan class=\"hljs-selector-class\"\u003e.AddAuthentication\u003c/span\u003e(options =\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        options.DefaultAuthenticateScheme = ApiKeyAuthenticationOptions.DefaultScheme;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        options.DefaultChallengeScheme = ApiKeyAuthenticationOptions.DefaultScheme;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    })\u003cspan class=\"hljs-selector-class\"\u003e.AddScheme\u003c/span\u003e\u0026lt;ApiKeyAuthenticationOptions, ApiKeyAuthenticationHandler\u0026gt;(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        ApiKeyAuthenticationOptions.DefaultScheme,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        null\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    );\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    services\u003cspan class=\"hljs-selector-class\"\u003e.AddAuthorization\u003c/span\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003epublic void \u003cspan class=\"hljs-built_in\"\u003eConfigure\u003c/span\u003e(IApplicationBuilder app, IWebHostEnvironment env)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    app\u003cspan class=\"hljs-selector-class\"\u003e.UseAuthentication\u003c/span\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    app\u003cspan class=\"hljs-selector-class\"\u003e.UseAuthorization\u003c/span\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch3\u003eAuthenticating a GraphQl Entity\u003c/h3\u003e\n\u003cp\u003eAuthentication in GraphQL works by authorizing individual models, to begin we first need to add the HotChocolate Authorization package \u003ccode\u003eHotChocolate.AspNetCore.Authorization\u003c/code\u003e and enable it in the \u003ccode\u003eStartup.cs\u003c/code\u003e class, its a one-liner,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003eservices\u003cspan class=\"hljs-selector-class\"\u003e.AddAuthorizeDirectiveType\u003c/span\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow similar to the \u003ccode\u003e[Authorize]\u003c/code\u003e tag we use for REST we can enable Authorization in for our individual ObjectTypes by adding a simple \u003ccode\u003edescriptor.Authorize()\u003c/code\u003e call.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-symbol\"\u003eCatType1\u003c/span\u003e : \u003cspan class=\"hljs-symbol\"\u003eObjectType\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-symbol\"\u003eCatResponse1\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eoverride\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003evoid\u003c/span\u003e Configure(IObjectTypeDescriptor\u0026lt;CatResponse1\u0026gt; descriptor)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        descriptor.Authorize();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOnce this has been added making calls without the header will return an unauthenticated result that looks like this,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  \u0026quot;errors\u0026quot;: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u0026quot;message\u0026quot;: \u003cspan class=\"hljs-string\"\u003e\u0026quot;The current user is not authorized to access this resource.\u0026quot;\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u003cspan class=\"hljs-string\"\u003e\u0026quot;locations\u0026quot;\u003c/span\u003e: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e          \u0026quot;\u003cspan class=\"hljs-selector-tag\"\u003eline\u003c/span\u003e\u0026quot;: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e          \u003cspan class=\"hljs-string\"\u003e\u0026quot;column\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u0026quot;\u003cspan class=\"hljs-selector-tag\"\u003epath\u003c/span\u003e\u0026quot;: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-string\"\u003e\u0026quot;cat1\u0026quot;\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-string\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u003cspan class=\"hljs-string\"\u003e\u0026quot;extensions\u0026quot;\u003c/span\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u0026quot;\u003cspan class=\"hljs-selector-tag\"\u003ecode\u003c/span\u003e\u0026quot;: \u003cspan class=\"hljs-string\"\u003e\u0026quot;AUTH_NOT_AUTHENTICATED\u0026quot;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003eHow to do Authorisation\u003c/h2\u003e\n\u003cp\u003eExtending the code to work with Authorization is also a quick change, in this example we will authorize based on the user\u0026#39;s role. To begin we will extend our \u003ccode\u003eApiKeyAuthenticationHandler\u003c/code\u003e to populate a claim when the authentication key has matched,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e claims = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e List\u0026lt;Claim\u0026gt; {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Claim(\u003cspan class=\"hljs-string\"\u003e\u0026quot;http://schemas.microsoft.com/ws/2008/06/identity/claims/role\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Admin\u0026quot;\u003c/span\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNext we can pass a list of accepted roles into the ObjectType \u003ccode\u003eCatType1\u003c/code\u003e, in this example I have intentionally added a role that doesn\u0026#39;t exist.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003evar roles \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e new string[] { \u003cspan class=\"hljs-string\"\u003e\u0026quot;NotAdmin\u0026quot;\u003c/span\u003e }\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003edescriptor.Authorize(roles)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eMaking a request now will spark an unauthorized error,\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs \"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e1\u003c/span\u003e\u003cspan class=\"line-content\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e2\u003c/span\u003e\u003cspan class=\"line-content\"\u003e  \u0026quot;errors\u0026quot;: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e3\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e4\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u0026quot;message\u0026quot;: \u003cspan class=\"hljs-string\"\u003e\u0026quot;The current user is not authorized to access this resource.\u0026quot;\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e5\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u003cspan class=\"hljs-string\"\u003e\u0026quot;locations\u0026quot;\u003c/span\u003e: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e6\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e7\u003c/span\u003e\u003cspan class=\"line-content\"\u003e          \u0026quot;\u003cspan class=\"hljs-selector-tag\"\u003eline\u003c/span\u003e\u0026quot;: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e8\u003c/span\u003e\u003cspan class=\"line-content\"\u003e          \u003cspan class=\"hljs-string\"\u003e\u0026quot;column\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e9\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e10\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e11\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u0026quot;\u003cspan class=\"hljs-selector-tag\"\u003epath\u003c/span\u003e\u0026quot;: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e12\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-string\"\u003e\u0026quot;cat1\u0026quot;\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e13\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e14\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u003cspan class=\"hljs-string\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e15\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e16\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      \u003cspan class=\"hljs-string\"\u003e\u0026quot;extensions\u0026quot;\u003c/span\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e17\u003c/span\u003e\u003cspan class=\"line-content\"\u003e        \u0026quot;\u003cspan class=\"hljs-selector-tag\"\u003ecode\u003c/span\u003e\u0026quot;: \u003cspan class=\"hljs-string\"\u003e\u0026quot;AUTH_NOT_AUTHORIZED\u0026quot;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e18\u003c/span\u003e\u003cspan class=\"line-content\"\u003e      }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e19\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"code-line\"\u003e\u003cspan class=\"line-number\"\u003e20\u003c/span\u003e\u003cspan class=\"line-content\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003eHow does logging work\u003c/h2\u003e\n\u003cp\u003eRegarding logging Chilli Cream has created a guide to adding an \u003ccode\u003eAddDiagnosticEventListener\u003c/code\u003e that\u0026#39;s able to trace incoming requests, check out the article \u003ca href=\"https://chillicream.com/blog/2021/01/10/hot-chocolate-logging\"\u003eLog Your Queries While Building a GraphQL Server\u003c/a\u003e. It would be interesting to create an example that\u0026#39;s \u003ccode\u003eOpenTelemetry\u003c/code\u003e compliant... perhaps that\u0026#39;s one for another day (this articles getting a bit long üò©).\u003c/p\u003e\n\u003ch1\u003eConclusion\u003c/h1\u003e\n\u003cp\u003eThat\u0026#39;s it folks! We\u0026#39;ve seen that the Hot Chocolate implementation nicely fulfils not just the 80% crud use case but can also deal with the other responsibilities we typically see with our REST services in the wild.\u003c/p\u003e\n"])</script><script>self.__next_f.push([1,"13:[\"$\",\"div\",null,{\"className\":\"page-module__dgei_G__content\",\"dangerouslySetInnerHTML\":{\"__html\":\"$17\"}}]\n14:[\"$\",\"$L16\",null,{\"url\":\"https://www.faesel.com/blog/aspnet-graphql-server-with-hot-chocolate\",\"title\":\"ASP.NET GraphQL server with Hot Chocolate\",\"description\":\"# Starting my journey with GraphQL\\n\\nUp till now, I've always heavily relied on RESTfull services to power API's, this recently got widened with GRPC which you c\"}]\n"])</script></body></html>