{"componentChunkName":"component---src-templates-blog-js","path":"/blog/evolving-windows-terminal","result":{"data":{"site":{"siteMetadata":{"siteUrl":"https://www.faesel.com"}},"contentfulBlog":{"title":"Evolving your Windows Terminal using Powershell libraries","slug":"evolving-windows-terminal","tags":["powershell","wsl","windows-terminal","powershell-gallery"],"hero":{"file":{"url":"//images.ctfassets.net/wjg1udsw901v/5WxA9oRmhEgKswEWyFjdbM/e0efe86ff8b93567fac16c1cfb7d951f/windowsterminalicon.jpg"},"title":"Windows Terminal Icon"},"datePublished":"July 24th, 2020","iso8601DatePublished":"2020-07-24T23:00:00.000Z","bodym":{"childMarkdownRemark":{"excerpt":"As a windows user the terminal experience has…","timeToRead":5,"html":"<p>As a windows user the terminal experience has always been lacking, up till the new <a href=\"https://www.microsoft.com/en-gb/p/windows-terminal/9n0dx20hk701?rtc=1&#x26;activetab=pivot:overviewtab\" target=\"_blank\" rel=\"nofollow\">windows terminal</a> was released. Incorporating <a href=\"https://docs.microsoft.com/en-us/windows/wsl/install-win10\" target=\"_blank\" rel=\"nofollow\">WSL (Windows Subsystem for Lynx)</a> really helped bridge that gap as it opens up console experience that makes use of <strong>apt-get</strong> use the plethora of packages available. </p>\n<p>Having tried using this for react apps I found the experience really slow when building apps. Running the same app in Powershell would start up in a fraction of the time. This got me thinking..</p>\n<blockquote>\n<p>Can I evolve my Powershell console experience in the same way I can with WSL?</p>\n</blockquote>\n<p>Looking at <a href=\"https://www.powershellgallery.com/\" target=\"_blank\" rel=\"nofollow\">Powershells Gallery</a>, they have a total of <strong>7,091</strong> unique packages. There must be some things here we can use.</p>\n<p>This article is about my journey from reading this blog post <a href=\"https://www.hanselman.com/blog/HowToMakeAPrettyPromptInWindowsTerminalWithPowerlineNerdFontsCascadiaCodeWSLAndOhmyposh.aspx\" target=\"_blank\" rel=\"nofollow\">\"How to make a pretty prompt in Windows Terminal with Powerline, Nerd Fonts, Cascadia Code, WSL, and oh-my-posh\"</a> by Scott Hanselman, to taking the experience one step further to evolve my terminal. Video on it here:</p>\n<p><iframe width=\"100%\" height=\"315\" src=\"https://www.youtube-nocookie.com/embed/lu__oGZVT98?rel=0\" frameBorder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowFullScreen></iframe></p>\n<h2 id=\"prerequisites\" style=\"position:relative;\"><a href=\"#prerequisites\" aria-label=\"prerequisites permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prerequisites</h2>\n<p>This article assumes you have already read Hanselman's article and kitted your terminal out with the following (if not do so):</p>\n<ul>\n<li>Added Cascadia Ligature Font, for more compact and expressive text.</li>\n<li>Added oh-my-posh, for better git branch information.</li>\n</ul>\n<h2 id=\"making-use-of-your-powershell-profile\" style=\"position:relative;\"><a href=\"#making-use-of-your-powershell-profile\" aria-label=\"making use of your powershell profile permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Making use of your Powershell profile</h2>\n<p>Before your Powershell window starts, any code in your Powershell profile is executed first. You can find your profile directory location by typing the following in your console,</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">$PROFILE</code>\n        </deckgo-highlight-code>\n      \n<p>It's from this file we can begin importing in scripts and adding custom functions. If you followed the prerequisites, your profile file will be mostly empty except perhaps a command to set the theme in oh-my-posh.</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">Set-Theme Paradox</code>\n        </deckgo-highlight-code>\n      \n<h2 id=\"incorporating-packages\" style=\"position:relative;\"><a href=\"#incorporating-packages\" aria-label=\"incorporating packages permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Incorporating packages</h2>\n<p>Before we start importing packages we need to get <strong>PowerShellGet</strong> setup, installation steps can be found here <a href=\"https://docs.microsoft.com/en-gb/powershell/scripting/gallery/installing-psget?view=powershell-7\" target=\"_blank\" rel=\"nofollow\">Installing PowerShellGet</a>. Once complete you can start installing scripts like so,</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">Install-Module -Name WifiTools </code>\n        </deckgo-highlight-code>\n      \n<p>That's it, you can actually start checking your wifi signal with <code>Show-WifiState</code> 📶! Aside from wifi tools here are some choice selections, some of these are recommended as it helps create building blocks for your own custom scripts:</p>\n<h3 id=\"1-terminal-icons\" style=\"position:relative;\"><a href=\"#1-terminal-icons\" aria-label=\"1 terminal icons permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://www.powershellgallery.com/packages/Terminal-Icons/0.1.1\" target=\"_blank\" rel=\"nofollow\">1. Terminal Icons</a></h3>\n<p><a href=\"https://www.powershellgallery.com/packages/Terminal-Icons/0.1.1\" target=\"_blank\" rel=\"nofollow\">Terminal-Icons</a> really helps improve visibility when navigating. It also allows you to format your directory list wide so that you can see all the files and folders without scrolling down.</p>\n<p>You can activate it in your Powershell profile by adding the following import</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">Import-Module -Name Terminal-Icons</code>\n        </deckgo-highlight-code>\n      \n<p>And that's it! witness the beauty:</p>\n<p><img src=\"//images.ctfassets.net/wjg1udsw901v/5GsSsHw0n1zQ2ST9ItYIM6/1f8e2a1d08542fdfaa24acc1b35dbc02/terminal-icons.png\" alt=\"Terminal Icons\"></p>\n<h3 id=\"2-tree\" style=\"position:relative;\"><a href=\"#2-tree\" aria-label=\"2 tree permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://www.powershellgallery.com/packages/Tree/1.0.1\" target=\"_blank\" rel=\"nofollow\">2. Tree</a></h3>\n<p><a href=\"https://www.powershellgallery.com/packages/Tree/1.0.1\" target=\"_blank\" rel=\"nofollow\">Tree</a> helps with directory discover and searching by printing in (as the name suggests) a tree structure. I alias this package and mainly use it for listing and searching, below is what you need in your Powershell profile,</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">Install-Module -Name Tree </code>\n        </deckgo-highlight-code>\n      \n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\"># Shows a tree structure of the current directory (excluding folders you want to ignore)\nfunction treels {\n    Get-ChildItemTree . -I &#39;node_modules|bin|obj|.git|.vs&#39;\n}\n\n# Searches the current directory for a pattern (wildcards * are accepted) and returns the tree view with matching files\nfunction treef ([string] $pattern) {\n    Get-ChildItemTree . -P $pattern -I &#39;node_modules|bin|obj|.git|.vs&#39;\n}</code>\n        </deckgo-highlight-code>\n      \n<p>Example showing a directory:</p>\n<p><img src=\"//images.ctfassets.net/wjg1udsw901v/2TiqouIH6bTQ4U6quojGO7/0c1d294bac92233dd453300b482afb93/TreeList.png\" alt=\"Tree Directory List\"></p>\n<p>Example search for a file:</p>\n<p><img src=\"//images.ctfassets.net/wjg1udsw901v/p7NOrYHf5oRdLz9IqwDzR/7de6b06b6233dc5d308dead818926593/TreeSearch.png\" alt=\"Tree Search\"></p>\n<h3 id=\"3-burnt-toast\" style=\"position:relative;\"><a href=\"#3-burnt-toast\" aria-label=\"3 burnt toast permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://www.powershellgallery.com/packages/BurntToast/0.7.1\" target=\"_blank\" rel=\"nofollow\">3. Burnt Toast</a></h3>\n<p><a href=\"https://www.powershellgallery.com/packages/BurntToast/0.7.1\" target=\"_blank\" rel=\"nofollow\">BurntToast</a> great package to notify yourself of any long running tasks. It hooks into the native windows toast notification system and has a plethora of options. One ideal use for this is cloning a repo (I'm talking about that repo dating back to the dinosaurs 🐉) since it lets you kick it off and automatically get a notification when done. </p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">Install-Module -Name BurntToast</code>\n        </deckgo-highlight-code>\n      \n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\"># clones a repo and notify with a toast\nfunction clonem([string] $url) {\n    git clone $url\n    New-BurntToastNotification -AppLogo &#39;C:\\Icons\\completed.png&#39; -Text &quot;Finished!&quot;, &#39;Finished cloning repo&#39;\n}</code>\n        </deckgo-highlight-code>\n      \n<p>I also find it great for scheduling in reminders, this one is dependent on a function which I import at the top of the profile <a href=\"https://github.com/Windos/BurntToast/blob/master/Examples/Example05/New-ToastReminder.ps1\" target=\"_blank\" rel=\"nofollow\">code example found here</a>.</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\"># IMPORT CUSTOM FILES\n. &quot;C:\\Users\\faese\\Documents\\WindowsPowerShell\\Custom\\BurntToast.ps1&quot;\n\n# trigger a remind after x minuites with some custom text\nfunction reminder([int]$minuites, [string]$text) {\n    New-ToastReminder -AppLogo &#39;C:\\Icons\\reminder.png&#39; -Minutes $minuites -ReminderTitle &#39;Reminder Reminder!&#39; -ReminderText $text\n}</code>\n        </deckgo-highlight-code>\n      \n<p>Example to ensure you never eggless,</p>\n<p><img src=\"//images.ctfassets.net/wjg1udsw901v/4zg5SUqQ14zjuZE6QArrj0/6f2809c3942708f89aea47dd3c815bdb/reminder.png\" alt=\"Toast Reminder\"></p>\n<h3 id=\"4-coloredtext\" style=\"position:relative;\"><a href=\"#4-coloredtext\" aria-label=\"4 coloredtext permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://www.powershellgallery.com/packages/ColoredText/1.0.6\" target=\"_blank\" rel=\"nofollow\">4. ColoredText</a></h3>\n<p>This library essentially allows you to print in different colours pure and simple. I mainly use this as a confirmation line when chaining together several commands so your eye just looks for coloured text to look for completion.</p>\n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\">Install-Module -Name ColoredText</code>\n        </deckgo-highlight-code>\n      \n\n        <deckgo-highlight-code   terminal=\"carbon\" line-numbers=\"true\" >\n          <code slot=\"code\"># create a new branch\nfunction newb([string]$branchName){\n    git branch $branchName\n    git checkout $branchName --track\n\n    $message = &quot;Finished creating branch: &quot; + $branchName\n\n    cprint black $message on rainbow print\n}\n\n# publish branch\nfunction publish {\n    $branchName = git rev-parse --abbrev-ref HEAD\n    git push --set-upstream origin $branchName\n\n    $message = &quot;Finished publishing branch: &quot; + $branchName\n\n    cprint black $message on rainbow print\n}</code>\n        </deckgo-highlight-code>\n      \n<p><img src=\"//images.ctfassets.net/wjg1udsw901v/6IctC3h57SGaYFmQelmlx4/2840d80d68895fe0dde359b64328c345/coloredtext.png\" alt=\"Colored Text\"></p>\n<h3 id=\"some-other-honourable-mentions\" style=\"position:relative;\"><a href=\"#some-other-honourable-mentions\" aria-label=\"some other honourable mentions permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Some other honourable mentions</h3>\n<p>Below are some other honourable mentions that I needed more time to investigate,</p>\n<ul>\n<li><a href=\"https://www.powershellgallery.com/packages/ps-menu/1.0.6\" target=\"_blank\" rel=\"nofollow\">PS Menu</a>, allows you to create a multi-select menu of options.</li>\n<li><a href=\"https://www.powershellgallery.com/packages/WTToolBox/1.6.0\" target=\"_blank\" rel=\"nofollow\">WTToolBox</a>, helps manage your windows terminal, I was mainly going to use this to get a list of shortcuts.</li>\n</ul>\n<h2 id=\"download-my-profile-code-here\" style=\"position:relative;\"><a href=\"#download-my-profile-code-here\" aria-label=\"download my profile code here permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Download my profile code here</h2>\n<p>You can download my complete profile code <a href=\"https://github.com/faesel/terminal-profile\" target=\"_blank\" rel=\"nofollow\">here</a></p>\n<h2 id=\"summary\" style=\"position:relative;\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"auto-link-header before\"><svg aria-hidden=\"true\" height=\"40\" width=\"40\" version=\"1.1\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h2>\n<p>I'm still on a path of discovery with Powershell, I've seen some great packages that can help make my terminal experience fast and efficient. However, I do feel I'm at the very beginning of this journey and with the continued improvements to WSL, I may flip flop to the Linux side.</p>"}}}},"pageContext":{"slug":"evolving-windows-terminal"}}}